!function(){"use strict";function e(){var t=this;this.middlewares=[],this.events={},this.on("run.setting",function(e){t.run(e)})}e.prototype.on=function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},e.prototype.emit=function(e,t){var n=this.events[e];if(!n||0===n.length)return!1;for(var r,i=0;r=n[i++];)r.call(this,t)},e.prototype.use=function(e){return this.middlewares.push(e),this},e.prototype.init=function(){window.$$__ptx_engage_$=this},e.prototype.run=function(e){if(!e)return!1;var t=this,n={window:window,setting:e,engager:t},r=0;!function i(){var e=t.middlewares[r++];e&&e(n,i)}()};var a=function(e){return"object"==typeof e?null!==e:"function"==typeof e},S=function(e){if(!a(e))throw TypeError(e+" is not an object!");return e},u=Object.is||function D(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},t={}.toString,i=function(e){return t.call(e).slice(8,-1)};function n(e,t){return e(t={exports:{}},t.exports),t.exports}var r,o,p=n(function(e){var t=e.exports={version:"2.6.1"};"number"==typeof __e&&(__e=t)}),v=(p.version,n(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),c=n(function(e){var t="__core-js_shared__",n=v[t]||(v[t]={});(e.exports=function(e,t){return n[e]||(n[e]=t!==undefined?t:{})})("versions",[]).push({version:p.version,mode:"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})}),s=0,l=Math.random(),d=function(e){return"Symbol(".concat(e===undefined?"":e,")_",(++s+l).toString(36))},f=n(function(e){var t=c("wks"),n=v.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:d)("Symbol."+e))}).store=t}),g=f("toStringTag"),h="Arguments"==i(function(){return arguments}()),m=function(e){var t,n,r;return e===undefined?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=Object(e),g))?n:h?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r},y=RegExp.prototype.exec,T=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==m(e))throw new TypeError("RegExp#exec called on incompatible receiver");return y.call(e,t)},w=function(){var e=S(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},b=RegExp.prototype.exec,_=String.prototype.replace,k=b,E="lastIndex",I=(r=/a/,o=/b*/g,b.call(r,"a"),b.call(o,"a"),0!==r[E]||0!==o[E]),x=/()??/.exec("")[1]!==undefined;(I||x)&&(k=function(e){var t,n,r,i,a=this;return x&&(n=new RegExp("^"+a.source+"$(?!\\s)",w.call(a))),I&&(t=a[E]),r=b.call(a,e),I&&r&&(a[E]=a.global?r.index+r[0].length:t),x&&r&&1<r.length&&_.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)arguments[i]===undefined&&(r[i]=undefined)}),r});var O=k,C=function(e){try{return!!e()}catch(t){return!0}},N=!C(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),A=v.document,D=a(A)&&a(A.createElement),P=function(e){return D?A.createElement(e):{}},L=!N&&!C(function(){return 7!=Object.defineProperty(P("div"),"a",{get:function(){return 7}}).a}),R=function(e,t){if(!a(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!a(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!a(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!a(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},W=Object.defineProperty,M={f:N?Object.defineProperty:function(e,t,n){if(S(e),t=R(t,!0),S(n),L)try{return W(e,t,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},j=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},V=N?function(e,t,n){return M.f(e,t,j(1,n))}:function(e,t,n){return e[t]=n,e},U={}.hasOwnProperty,F=function(e,t){return U.call(e,t)},G=n(function(e){var a=d("src"),t="toString",n=Function[t],o=(""+n).split(t);p.inspectSource=function(e){return n.call(e)},(e.exports=function(e,t,n,r){var i="function"==typeof n;i&&(F(n,"name")||V(n,"name",t)),e[t]!==n&&(i&&(F(n,a)||V(n,a,e[t]?""+e[t]:o.join(String(t)))),e===v?e[t]=n:r?e[t]?e[t]=n:V(e,t,n):(delete e[t],V(e,t,n)))})(Function.prototype,t,function(){return"function"==typeof this&&this[a]||n.call(this)})}),B=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},$=function(r,i,e){if(B(r),i===undefined)return r;switch(e){case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}},H="prototype",J=function(e,t,n){var r,i,a,o,c=e&J.F,u=e&J.G,s=e&J.S,l=e&J.P,d=e&J.B,f=u?v:s?v[t]||(v[t]={}):(v[t]||{})[H],g=u?p:p[t]||(p[t]={}),h=g[H]||(g[H]={});for(r in u&&(n=t),n)a=((i=!c&&f&&f[r]!==undefined)?f:n)[r],o=d&&i?$(a,v):l&&"function"==typeof a?$(Function.call,a):a,f&&G(f,r,a,e&J.U),g[r]!=a&&V(g,r,o),l&&h[r]!=a&&(h[r]=a)};v.core=p,J.F=1,J.G=2,J.S=4,J.P=8,J.B=16,J.W=32,J.U=64,J.R=128;var q=J;q({target:"RegExp",proto:!0,forced:O!==/./.exec},{exec:O});var z=function(e){if(e==undefined)throw TypeError("Can't call method on  "+e);return e},X=f("species"),K=!C(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),Y=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),Z=function(n,e,t){var r=f(n),a=!C(function(){var e={};return e[r]=function(){return 7},7!=""[n](e)}),i=a?!C(function(){var e=!1,t=/a/;return t.exec=function(){return e=!0,null},"split"===n&&(t.constructor={},t.constructor[X]=function(){return t}),t[r](""),!e}):undefined;if(!a||!i||"replace"===n&&!K||"split"===n&&!Y){var o=/./[r],c=t(z,r,""[n],function(e,t,n,r,i){return t.exec===O?a&&!i?{done:!0,value:o.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),u=c[0],s=c[1];G(String.prototype,n,u),V(RegExp.prototype,r,2==e?function(e,t){return s.call(e,this,t)}:function(e){return s.call(e,this)})}};Z("search",1,function(r,i,o,c){return[function(e){var t=r(this),n=e==undefined?undefined:e[i];return n!==undefined?n.call(e,t):new RegExp(e)[i](String(t))},function(e){var t=c(o,e,this);if(t.done)return t.value;var n=S(e),r=String(this),i=n.lastIndex;u(i,0)||(n.lastIndex=0);var a=T(n,r);return u(n.lastIndex,i)||(n.lastIndex=i),null===a?-1:a.index}]});var Q,ee=Math.ceil,te=Math.floor,ne=function(e){return isNaN(e=+e)?0:(0<e?te:ee)(e)},re=Math.min,ie=function(e){return 0<e?re(ne(e),9007199254740991):0},ae=(Q=!0,function(e,t){var n,r,i=String(z(e)),a=ne(t),o=i.length;return a<0||o<=a?Q?"":undefined:(n=i.charCodeAt(a))<55296||56319<n||a+1===o||(r=i.charCodeAt(a+1))<56320||57343<r?Q?i.charAt(a):n:Q?i.slice(a,a+2):r-56320+(n-55296<<10)+65536}),oe=function(e,t,n){return t+(n?ae(e,t).length:1)};Z("match",1,function(r,i,s,l){return[function(e){var t=r(this),n=e==undefined?undefined:e[i];return n!==undefined?n.call(e,t):new RegExp(e)[i](String(t))},function(e){var t=l(s,e,this);if(t.done)return t.value;var n=S(e),r=String(this);if(!n.global)return T(n,r);for(var i,a=n.unicode,o=[],c=n.lastIndex=0;null!==(i=T(n,r));){var u=String(i[0]);""===(o[c]=u)&&(n.lastIndex=oe(r,ie(n.lastIndex),a)),c++}return 0===c?null:o}]});var ce=f("match"),ue=function(e){var t;return a(e)&&((t=e[ce])!==undefined?!!t:"RegExp"==i(e))},se=f("species"),le=Math.min,de=[].push,fe="split",ge="length",he="lastIndex",pe=!!function(){try{return new RegExp("x","y")}catch(e){}}();Z("split",2,function(i,a,w,b){var _;return _="c"=="abbc"[fe](/(b)*/)[1]||4!="test"[fe](/(?:)/,-1)[ge]||2!="ab"[fe](/(?:ab)*/)[ge]||4!="."[fe](/(.?)(.?)/)[ge]||1<"."[fe](/()()/)[ge]||""[fe](/.?/)[ge]?function(e,t){var n=String(this);if(e===undefined&&0===t)return[];if(!ue(e))return w.call(n,e,t);for(var r,i,a,o=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,s=t===undefined?4294967295:t>>>0,l=new RegExp(e.source,c+"g");(r=O.call(l,n))&&!(u<(i=l[he])&&(o.push(n.slice(u,r.index)),1<r[ge]&&r.index<n[ge]&&de.apply(o,r.slice(1)),a=r[0][ge],u=i,o[ge]>=s));)l[he]===r.index&&l[he]++;return u===n[ge]?!a&&l.test("")||o.push(""):o.push(n.slice(u)),o[ge]>s?o.slice(0,s):o}:"0"[fe](undefined,0)[ge]?function(e,t){return e===undefined&&0===t?[]:w.call(this,e,t)}:w,[function(e,t){var n=i(this),r=e==undefined?undefined:e[a];return r!==undefined?r.call(e,n,t):_.call(String(n),e,t)},function(e,t){var n=b(_,e,this,t,_!==w);if(n.done)return n.value;var r,i,a,o=S(e),c=String(this),u=(r=RegExp,(a=S(o).constructor)===undefined||(i=S(a)[se])==undefined?r:B(i)),s=o.unicode,l=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(pe?"y":"g"),d=new u(pe?o:"^(?:"+o.source+")",l),f=t===undefined?4294967295:t>>>0;if(0===f)return[];if(0===c.length)return null===T(d,c)?[c]:[];for(var g=0,h=0,p=[];h<c.length;){d.lastIndex=pe?h:0;var v,m=T(d,pe?c:c.slice(h));if(null===m||(v=le(ie(d.lastIndex+(pe?0:h)),c.length))===g)h=oe(c,h,s);else{if(p.push(c.slice(g,h)),p.length===f)return p;for(var y=1;y<=m.length-1;y++)if(p.push(m[y]),p.length===f)return p;h=g=v}}return p.push(c.slice(g)),p}]});var ve,me={f:{}.propertyIsEnumerable},ye=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)},we=function(e){return ye(z(e))},be=Object.getOwnPropertyDescriptor,_e={f:N?be:function(e,t){if(e=we(e),t=R(t,!0),L)try{return be(e,t)}catch(n){}if(F(e,t))return j(!me.f.call(e,t),e[t])}},ke=function(e,t){if(S(e),!a(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},Ee={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,r){try{(r=$(Function.call,_e.f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(t){n=!0}return function(e,t){return ke(e,t),n?e.__proto__=t:r(e,t),e}}({},!1):undefined),check:ke}.set,Se=function(e,t,n){var r,i=t.constructor;return i!==n&&"function"==typeof i&&(r=i.prototype)!==n.prototype&&a(r)&&Ee&&Ee(e,r),e},Te=Math.max,Ie=Math.min,xe=c("keys"),Oe=function(e){return xe[e]||(xe[e]=d(e))},Ce=(ve=!1,function(e,t,n){var r,i,a,o=we(e),c=ie(o.length),u=(i=c,(r=ne(r=n))<0?Te(r+i,0):Ie(r,i));if(ve&&t!=t){for(;u<c;)if((a=o[u++])!=a)return!0}else for(;u<c;u++)if((ve||u in o)&&o[u]===t)return ve||u||0;return!ve&&-1}),Ne=Oe("IE_PROTO"),Ae=function(e,t){var n,r=we(e),i=0,a=[];for(n in r)n!=Ne&&F(r,n)&&a.push(n);for(;t.length>i;)F(r,n=t[i++])&&(~Ce(a,n)||a.push(n));return a},De="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Pe=De.concat("length","prototype"),Le={f:Object.getOwnPropertyNames||function(e){return Ae(e,Pe)}},Re="\t\n\x0B\f\r   ᠎             　\u2028\u2029\ufeff",We="["+Re+"]",Me=RegExp("^"+We+We+"*"),je=RegExp(We+We+"*$"),Ve=function(e,t,n){var r={},i=C(function(){return!!Re[e]()||"​"!="​"[e]()}),a=r[e]=i?t(Ue):Re[e];n&&(r[n]=a),q(q.P+q.F*i,"String",r)},Ue=Ve.trim=function(e,t){return e=String(z(e)),1&t&&(e=e.replace(Me,"")),2&t&&(e=e.replace(je,"")),e},Fe=Ve,Ge=Object.keys||function st(e){return Ae(e,De)},Be=N?Object.defineProperties:function(e,t){S(e);for(var n,r=Ge(t),i=r.length,a=0;a<i;)M.f(e,n=r[a++],t[n]);return e},$e=v.document,He=$e&&$e.documentElement,Je=Oe("IE_PROTO"),qe=function(){},ze="prototype",Xe=function(){var e,t=P("iframe"),n=De.length;for(t.style.display="none",He.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),Xe=e.F;n--;)delete Xe[ze][De[n]];return Xe()},Ke=Object.create||function(e,t){var n;return null!==e?(qe[ze]=S(e),n=new qe,qe[ze]=null,n[Je]=e):n=Xe(),t===undefined?n:Be(n,t)},Ye=Le.f,Ze=_e.f,Qe=M.f,et=Fe.trim,tt="Number",nt=v[tt],rt=nt,it=nt.prototype,at=i(Ke(it))==tt,ot="trim"in String.prototype,ct=function(e){var t=R(e,!1);if("string"==typeof t&&2<t.length){var n,r,i,a=(t=ot?t.trim():et(t,3)).charCodeAt(0);if(43===a||45===a){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var o,c=t.slice(2),u=0,s=c.length;u<s;u++)if((o=c.charCodeAt(u))<48||i<o)return NaN;return parseInt(c,r)}}return+t};if(!nt(" 0o1")||!nt("0b1")||nt("+0x1")){nt=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof nt&&(at?C(function(){it.valueOf.call(n)}):i(n)!=tt)?Se(new rt(ct(t)),n,nt):ct(t)};for(var ut,st=N?Ye(rt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),lt=0;st.length>lt;lt++)F(rt,ut=st[lt])&&!F(nt,ut)&&Qe(nt,ut,Ze(rt,ut));(nt.prototype=it).constructor=nt,G(v,tt,nt)}var dt=function(e){return Object(z(e))},ft=Array.isArray||function(e){return"Array"==i(e)},gt=f("species"),ht=function(e,t){return ft(n=e)&&("function"!=typeof(r=n.constructor)||r!==Array&&!ft(r.prototype)||(r=undefined),a(r)&&null===(r=r[gt])&&(r=undefined)),new(r===undefined?Array:r)(t);var n,r},pt=f("unscopables"),vt=Array.prototype;vt[pt]==undefined&&V(vt,pt,{});var mt,yt,wt,bt,_t,kt,Et,St,Tt,It=function(e){vt[pt][e]=!0},xt=(wt=1==(mt=5),bt=2==mt,_t=3==mt,kt=4==mt,Et=6==mt,St=5==mt||Et,Tt=yt||ht,function(e,t,n){for(var r,i,a=dt(e),o=ye(a),c=$(t,n,3),u=ie(o.length),s=0,l=wt?Tt(e,u):bt?Tt(e,0):undefined;s<u;s++)if((St||s in o)&&(i=c(r=o[s],s,a),mt))if(wt)l[s]=i;else if(i)switch(mt){case 3:return!0;case 5:return r;case 6:return s;case 2:l.push(r)}else if(kt)return!1;return Et?-1:_t||kt?kt:l}),Ot="find",Ct=!0;Ot in[]&&Array(1)[Ot](function(){Ct=!1}),q(q.P+q.F*Ct,"Array",{find:function(e){return xt(this,e,1<arguments.length?arguments[1]:undefined)}}),It(Ot);var Nt=function(e,t){return{value:t,done:!!e}},At={},Dt=M.f,Pt=f("toStringTag"),Lt=function(e,t,n){e&&!F(e=n?e:e.prototype,Pt)&&Dt(e,Pt,{configurable:!0,value:t})},Rt={};V(Rt,f("iterator"),function(){return this});var Wt=Oe("IE_PROTO"),Mt=Object.prototype,jt=Object.getPrototypeOf||function(e){return e=dt(e),F(e,Wt)?e[Wt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Mt:null},Vt=f("iterator"),Ut=!([].keys&&"next"in[].keys()),Ft="values",Gt=function(){return this},Bt=function(e,t,n,r,i,a,o){var c,u,s;u=t,s=r,(c=n).prototype=Ke(Rt,{next:j(1,s)}),Lt(c,u+" Iterator");var l,d,f,g=function(e){if(!Ut&&e in m)return m[e];switch(e){case"keys":case Ft:return function(){return new n(this,e)}}return function(){return new n(this,e)}},h=t+" Iterator",p=i==Ft,v=!1,m=e.prototype,y=m[Vt]||m["@@iterator"]||i&&m[i],w=y||g(i),b=i?p?g("entries"):w:undefined,_="Array"==t&&m.entries||y;if(_&&(f=jt(_.call(new e)))!==Object.prototype&&f.next&&(Lt(f,h,!0),"function"!=typeof f[Vt]&&V(f,Vt,Gt)),p&&y&&y.name!==Ft&&(v=!0,w=function(){return y.call(this)}),(Ut||v||!m[Vt])&&V(m,Vt,w),At[t]=w,At[h]=Gt,i)if(l={values:p?w:g(Ft),keys:a?w:g("keys"),entries:b},o)for(d in l)d in m||G(m,d,l[d]);else q(q.P+q.F*(Ut||v),t,l);return l}(Array,"Array",function(e,t){this._t=we(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=undefined,Nt(1)):Nt(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values");At.Arguments=At.Array,It("keys"),It("values"),It("entries");for(var $t=f("iterator"),Ht=f("toStringTag"),Jt=At.Array,qt={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},zt=Ge(qt),Xt=0;Xt<zt.length;Xt++){var Kt,Yt=zt[Xt],Zt=qt[Yt],Qt=v[Yt],en=Qt&&Qt.prototype;if(en&&(en[$t]||V(en,$t,Jt),en[Ht]||V(en,Ht,Yt),At[Yt]=Jt,Zt))for(Kt in Bt)en[Kt]||G(en,Kt,Bt[Kt],!0)}var tn={};tn[f("toStringTag")]="z",tn+""!="[object z]"&&G(Object.prototype,"toString",function t(){return"[object "+m(this)+"]"},!0);var nn,rn,an,on;function cn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sn(e,t,n){return t&&un(e.prototype,t),n&&un(e,n),e}function ln(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function dn(i){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ln(Object(a),!0).forEach(function(e){var t,n,r;t=i,r=a[n=e],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):ln(Object(a)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})}return i}function fn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hn(e,t)}function gn(e){return(gn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hn(e,t){return(hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vn(r){var i=function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=gn(r);if(i){var n=gn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return pn(this,e)}}function mn(e){throw new Error('"'+e+'" is read-only')}function yn(e){return function t(e){if(Array.isArray(e))return wn(e)}(e)||function n(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function r(e,t){if(!e)return;if("string"==typeof e)return wn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wn(e,t)}(e)||function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}nn="keys",rn=function(){return function(e){return Ge(dt(e))}},an=(p.Object||{})[nn]||Object[nn],(on={})[nn]=rn(an),q(q.S+q.F*C(function(){an(1)}),"Object",on);var bn,_n=f("species"),kn=M.f,En=Le.f,Sn=v.RegExp,Tn=Sn,In=Sn.prototype,xn=/a/g,On=/a/g,Cn=new Sn(xn)!==xn;if(N&&(!Cn||C(function(){return On[f("match")]=!1,Sn(xn)!=xn||Sn(On)==On||"/a/i"!=Sn(xn,"i")}))){Sn=function(e,t){var n=this instanceof Sn,r=ue(e),i=t===undefined;return!n&&r&&e.constructor===Sn&&i?e:Se(Cn?new Tn(r&&!i?e.source:e,t):Tn((r=e instanceof Sn)?e.source:e,r&&i?w.call(e):t),n?this:In,Sn)};for(var Nn=function(t){t in Sn||kn(Sn,t,{configurable:!0,get:function(){return Tn[t]},set:function(e){Tn[t]=e}})},An=En(Tn),Dn=0;An.length>Dn;)Nn(An[Dn++]);(In.constructor=Sn).prototype=In,G(v,"RegExp",Sn)}bn=v["RegExp"],N&&bn&&!bn[_n]&&M.f(bn,_n,{configurable:!0,get:function(){return this}});var Pn=M.f,Ln=Function.prototype,Rn=/^\s*function ([^ (]*)/;"name"in Ln||N&&Pn(Ln,"name",{configurable:!0,get:function(){try{return(""+this).match(Rn)[1]}catch(e){return""}}}),N&&"g"!=/./g.flags&&M.f(RegExp.prototype,"flags",{configurable:!0,get:w});var Wn="toString",Mn=/./[Wn],jn=function(e){G(RegExp.prototype,Wn,e,!0)};C(function(){return"/a/b"!=Mn.call({source:"a",flags:"b"})})?jn(function t(){var e=S(this);return"/".concat(e.source,"/","flags"in e?e.flags:!N&&e instanceof RegExp?w.call(e):undefined)}):Mn.name!=Wn&&jn(function t(){return Mn.call(this)});var Vn=Math.max,Un=Math.min,Fn=Math.floor,Gn=/\$([$&`']|\d\d?|<[^>]*>)/g,Bn=/\$([$&`']|\d\d?)/g;Z("replace",2,function(i,a,_,k){return[function(e,t){var n=i(this),r=e==undefined?undefined:e[a];return r!==undefined?r.call(e,n,t):_.call(String(n),e,t)},function(e,t){var n=k(_,e,this,t);if(n.done)return n.value;var r=S(e),i=String(this),a="function"==typeof t;a||(t=String(t));var o=r.global;if(o){var c=r.unicode;r.lastIndex=0}for(var u=[];;){var s=T(r,i);if(null===s)break;if(u.push(s),!o)break;""===String(s[0])&&(r.lastIndex=oe(i,ie(r.lastIndex),c))}for(var l,d="",f=0,g=0;g<u.length;g++){s=u[g];for(var h=String(s[0]),p=Vn(Un(ne(s.index),i.length),0),v=[],m=1;m<s.length;m++)v.push((l=s[m])===undefined?l:String(l));var y=s.groups;if(a){var w=[h].concat(v,p,i);y!==undefined&&w.push(y);var b=String(t.apply(undefined,w))}else b=E(h,i,p,v,y,t);f<=p&&(d+=i.slice(f,p)+b,f=p+h.length)}return d+i.slice(f)}];function E(a,o,c,u,s,e){var l=c+a.length,d=u.length,t=Bn;return s!==undefined&&(s=dt(s),t=Gn),_.call(e,t,function(e,t){var n;switch(t.charAt(0)){case"$":return"$";case"&":return a;case"`":return o.slice(0,c);case"'":return o.slice(l);case"<":n=s[t.slice(1,-1)];break;default:var r=+t;if(0===r)return t;if(d<r){var i=Fn(r/10);return 0===i?t:i<=d?u[i-1]===undefined?t.charAt(1):u[i-1]+t.charAt(1):t}n=u[r-1]}return n===undefined?"":n})}});var $n,Hn,Jn=[].sort,qn=[1,2,3];q(q.P+q.F*(C(function(){qn.sort(undefined)})||!C(function(){qn.sort(null)})||!(($n=Jn)&&C(function(){Hn?$n.call(null,function(){},1):$n.call(null)}))),"Array",{sort:function(e){return e===undefined?Jn.call(dt(this)):Jn.call(dt(this),B(e))}});var zn={sidLabel:"PTX_SID",funName:"ptengine",events:["track","page","identify"],dataLayer:"_pt_data_layer",antiFlickerClassName:"pt-async-hide",previewToken:"preview_ptx_token",engageEditorToken:"ptengine_engage_editor_token",engageControlgroupToken:"ptengine_engage_control_group"},Xn=("https:"===location.protocol?"https://":"http://")+"egjsmonitor.ptengine.jp";function Kn(){try{var e=window.screen.width;return e?isNaN(parseInt(e,10))?0:parseInt(e,10):0}catch(t){return 0}}function Yn(){var e=self.innerWidth||document.body.clientWidth;return e=isNaN(e)?0:parseInt(e,10)}function Zn(){try{var e=window.screen.height;return(1===cr()&&2e3<e||4===cr()&&3e3<e)&&(e=function n(){try{var e=self.innerHeight||document.body.clientHeight;return e=isNaN(e)?0:parseInt(e,10)}catch(t){return 0}}()),e?isNaN(parseInt(e,10))?0:parseInt(e,10):0}catch(t){return 0}}function Qn(){var e=[];return 1===cr()||4===cr()?(e.push("."+[Yn(),Zn()].sort()[0]),e.push("."+[Yn(),Zn()].sort()[1])):(e.push("."+Kn()),e.push("."+Zn())),e.push("."+(window.screen.colorDepth||0)),e.push("."+function n(){try{var e=(new Date).getTimezoneOffset();return e||0===e?"GMT"+(e<=0?"+":"")+e/60*-1:""}catch(t){return""}}().replace(/\./g,"_")),e.push("."+(navigator.platform||"").replace(/\./g,"_").toLowerCase()),e.push("."+(navigator.language||navigator.browserLanguage||"").replace(/\./g,"_").toLowerCase()),e.push("."+(document.characterSet||document.charset||"").replace(/\./g,"_").toLowerCase()),e.join("")}function er(e){function u(e,t){return e<<t|e>>>32-t}function s(e,t){var n,r,i,a,o;return i=2147483648&e,a=2147483648&t,o=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(r=1073741824&t)?2147483648^o^i^a:n|r?1073741824&o?3221225472^o^i^a:1073741824^o^i^a:o^i^a}function t(e,t,n,r,i,a,o){return s(u(e=s(e,s(s(function c(e,t,n){return e&t|~e&n}(t,n,r),i),o)),a),t)}function n(e,t,n,r,i,a,o){return s(u(e=s(e,s(s(function c(e,t,n){return e&n|t&~n}(t,n,r),i),o)),a),t)}function r(e,t,n,r,i,a,o){return s(u(e=s(e,s(s(function c(e,t,n){return e^t^n}(t,n,r),i),o)),a),t)}function i(e,t,n,r,i,a,o){return s(u(e=s(e,s(s(function c(e,t,n){return t^(e|~n)}(t,n,r),i),o)),a),t)}function a(e){var t,n="",r="";for(t=0;t<=3;t++)n+=(r="0"+(e>>>8*t&255).toString(16)).substr(r.length-2,2);return n}var o,c,l,d,f,g,h,p,v,m=Array();for(m=function y(e){for(var t,n=e.length,r=n+8,i=16*((r-r%64)/64+1),a=Array(i-1),o=0,c=0;c<n;)o=c%4*8,a[t=(c-c%4)/4]=a[t]|e.charCodeAt(c)<<o,c++;return o=c%4*8,a[t=(c-c%4)/4]=a[t]|128<<o,a[i-2]=n<<3,a[i-1]=n>>>29,a}(e),g=1732584193,h=4023233417,p=2562383102,v=271733878,o=0;o<m.length;o+=16)h=i(h=i(h=i(h=i(h=r(h=r(h=r(h=r(h=n(h=n(h=n(h=n(h=t(h=t(h=t(h=t(l=h,p=t(d=p,v=t(f=v,g=t(c=g,h,p,v,m[o+0],7,3614090360),h,p,m[o+1],12,3905402710),g,h,m[o+2],17,606105819),v,g,m[o+3],22,3250441966),p=t(p,v=t(v,g=t(g,h,p,v,m[o+4],7,4118548399),h,p,m[o+5],12,1200080426),g,h,m[o+6],17,2821735955),v,g,m[o+7],22,4249261313),p=t(p,v=t(v,g=t(g,h,p,v,m[o+8],7,1770035416),h,p,m[o+9],12,2336552879),g,h,m[o+10],17,4294925233),v,g,m[o+11],22,2304563134),p=t(p,v=t(v,g=t(g,h,p,v,m[o+12],7,1804603682),h,p,m[o+13],12,4254626195),g,h,m[o+14],17,2792965006),v,g,m[o+15],22,1236535329),p=n(p,v=n(v,g=n(g,h,p,v,m[o+1],5,4129170786),h,p,m[o+6],9,3225465664),g,h,m[o+11],14,643717713),v,g,m[o+0],20,3921069994),p=n(p,v=n(v,g=n(g,h,p,v,m[o+5],5,3593408605),h,p,m[o+10],9,38016083),g,h,m[o+15],14,3634488961),v,g,m[o+4],20,3889429448),p=n(p,v=n(v,g=n(g,h,p,v,m[o+9],5,568446438),h,p,m[o+14],9,3275163606),g,h,m[o+3],14,4107603335),v,g,m[o+8],20,1163531501),p=n(p,v=n(v,g=n(g,h,p,v,m[o+13],5,2850285829),h,p,m[o+2],9,4243563512),g,h,m[o+7],14,1735328473),v,g,m[o+12],20,2368359562),p=r(p,v=r(v,g=r(g,h,p,v,m[o+5],4,4294588738),h,p,m[o+8],11,2272392833),g,h,m[o+11],16,1839030562),v,g,m[o+14],23,4259657740),p=r(p,v=r(v,g=r(g,h,p,v,m[o+1],4,2763975236),h,p,m[o+4],11,1272893353),g,h,m[o+7],16,4139469664),v,g,m[o+10],23,3200236656),p=r(p,v=r(v,g=r(g,h,p,v,m[o+13],4,681279174),h,p,m[o+0],11,3936430074),g,h,m[o+3],16,3572445317),v,g,m[o+6],23,76029189),p=r(p,v=r(v,g=r(g,h,p,v,m[o+9],4,3654602809),h,p,m[o+12],11,3873151461),g,h,m[o+15],16,530742520),v,g,m[o+2],23,3299628645),p=i(p,v=i(v,g=i(g,h,p,v,m[o+0],6,4096336452),h,p,m[o+7],10,1126891415),g,h,m[o+14],15,2878612391),v,g,m[o+5],21,4237533241),p=i(p,v=i(v,g=i(g,h,p,v,m[o+12],6,1700485571),h,p,m[o+3],10,2399980690),g,h,m[o+10],15,4293915773),v,g,m[o+1],21,2240044497),p=i(p,v=i(v,g=i(g,h,p,v,m[o+8],6,1873313359),h,p,m[o+15],10,4264355552),g,h,m[o+6],15,2734768916),v,g,m[o+13],21,1309151649),p=i(p,v=i(v,g=i(g,h,p,v,m[o+4],6,4149444226),h,p,m[o+11],10,3174756917),g,h,m[o+2],15,718787259),v,g,m[o+9],21,3951481745),g=s(g,c),h=s(h,l),p=s(p,d),v=s(v,f);return a(g)+a(h)+a(p)+a(v)}function tr(e){var t=e.method,n=e.data,r=e.url,i=e.callback,a=e.contentType,o=e.async;r=r+"?traceId="+nr(),t=t||"GET";var c=new XMLHttpRequest;"withCredentials"in c?c.open(t,r,!0):"undefined"!=typeof XDomainRequest?(mn("xhr"),(c=new window.XDomainRequest).open(t,r,o)):(mn("xhr"),c=null),a&&c.setRequestHeader("Content-Type",a),c.setRequestHeader("Strict-Transport-Security","max-age=0; includeSubDomains"),c&&(i&&(c.onreadystatechange=function(){4!==c.readyState||200!==c.status&&201!==c.status||i(c.responseText)}),c.send(n))}function nr(){var e=navigator.userAgent,t=(new Date).getTime(),n=Math.random(),r=document.documentElement.clientWidth||document.body.clientWidth||0,i=0;try{i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}catch(o){}var a=ir();return er("ua=".concat(e,"&ts=").concat(t,"&random=").concat(n,"&bw=").concat(r,"&bh=").concat(i,"&plugins=").concat(a))}function rr(e){try{var t=[Qn()];t.push("&ua="+function r(e,t){return encodeURIComponent instanceof Function?t?encodeURI(e):encodeURIComponent(e):escape(e)}(navigator.userAgent||"",!1)),t.push("&bw="+(document.documentElement.clientWidth||document.body.clientWidth||0)),t.push("&bh="+function i(){try{var e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return e?isNaN(parseInt(e,10))?0:parseInt(e,10):0}catch(t){return 0}}()),t.push("&pi="+ir()),t.push("&ts="+e);var n=t.join("");return n||(n=(new Date).getTime()+""+Math.random()),n}catch(a){return(new Date).getTime()+""+Math.random()}}function ir(){var e="",t=navigator.plugins;if(0!==t.length){for(var n=[],r=0;r<t.length;r++){n[r]=t[r].name+";"+t[r].description+";"+t[r].filename+";";for(var i=0;i<t[r].length;i++)n[r]+="("+t[r][i].description+";"+t[r][i].type+";"+t[r][i].suffixes+")";n[r]+="."}e=n.sort().join("")}return e}var ar={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,r,i,a){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var o="";if(n)switch(n.constructor){case Number:o=n===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:o="; expires="+n;break;case Date:o="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+o+(i?"; domain="+i:"")+(r?"; path="+r:"")+(a?"; secure":""),!0},removeItem:function(e,t,n){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function st(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}};function or(e,t){var n=ar.getItem("ptx_"+e);return n&&-1!==n.indexOf(t)?n.split(t+"=")[1].split("&")[0]:""}function cr(){try{var e=navigator.userAgent;return e?function r(){var e=navigator.platform.toLowerCase();if(-1<e.indexOf("win"))return!0;for(var t=["mac68k","macppc","macintosh","macintel"],n=0;n<t.length;n++)if(e===t[n])return!0;return!1}()||function i(e){for(var t=["AIX","Amiga","BeOS","DragonFly","FreeBSD","GNU","Haiku","HP-UX","IRIX","Joli","Java","Macintosh","Minix","MorphOS","NetBSD","OpenBSD","PClinuxOS","QNX x86pc","SunOS","Ubuntu","Mint","Red Hat","Slackware","SUSE","PCLinuxOS","Debian","Fedora","CentOS","Vine","Arch Linux","Gentoo","Kanotix","Mandriva"],n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(e)?function a(e){for(var t=["Android","AROS","Bada","BlackBerry","Chromium","CrOS","Danger Hiptop","Inferno","iPhone","iPad","iPod","Nintendo DS","Nintendo Wii","Palm OS","PLAYSTATION","Syllable","SymbOS","Symbian","Tizen","webOS","WebTV","Windows CE","Windows Mobile","Windows Phone","Xbox"],n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(e)?3:e.match(/.*MSIE.*Windows NT 6\.2;.*Touch\).*/)?4:2:-1<e.indexOf("iPad")||1e3<=Math.min(Kn(),window.screen.height)?4:1:0}catch(t){return 0}}function ur(n){if("string"==typeof n){return["?","^","$","*","+","(",")","|"].map(function(e){var t=new RegExp("(\\"+e+")","g");n=n.replace(t,"\\$1")}),n}}function sr(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=location.search.substr(1).match(t);return null!=n?decodeURIComponent(n[2]):null}function lr(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function dr(){return window.PTX_PREVIEW_ID?"ptx_preview_"+window.PTX_PREVIEW_ID:window.PT_ENGAGE_IN_DEBUG?"ptx_engager_debug":"ptx_engager"}function fr(e,t){if(e){var n=dr(),r=JSON.parse(localStorage.getItem(n)||"{}");r[e]=t,localStorage.setItem(n,JSON.stringify(r))}}function gr(e){var t;if(e){var n=dr(),r=JSON.parse(localStorage.getItem(n)||"{}");Object.prototype.hasOwnProperty.call(r,e)&&(t=r[e])}return t}function hr(e,t){localStorage.getItem("ptx_enableLog")}function pr(){return/MicroMessenger/i.test(navigator.userAgent)}function vr(e,t){var n=location.href;(new Image).src="".concat(Xn,"?p=").concat(n,"t=").concat(e,"&ex=").concat(t)}function mr(e){for(var t=[],n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.join("")}function yr(){return localStorage.getItem(zn.sidLabel)}var wr,br=function(){function e(){cn(this,e),this.timezone=""}return sn(e,[{key:"setTimeZone",value:function(e){this.timezone=e}},{key:"getProfileTimeStamp",value:function(){var e=0;if(this.timezone.trim()){var t,n=60*(new Date).getTimezoneOffset()*1e3*-1,r=this.timezone.replace(":"," ").split(" ");2==r.length&&(t=60*Number(r[0].slice(1))*60*1e3+60*Number(r[1])*1e3,t=Number(r[0].slice(0,1)+t));var i=n-t;e=Date.now()-i}return e}}]),e}(),_r=new(function(){function e(){cn(this,e),this.cache={}}return sn(e,[{key:"get",value:function(e){return this.cache[e]}},{key:"set",value:function(e,t){this.cache[e]=t}}]),e}()),kr=new br,Er=(new Date).getTime(),Sr=window._pt_data_layer||(window._pt_data_layer=[]),Tr={SILENCEDURATION:3e5,HEARTBEATINTERVAL:15e3,CLICKINTERVAL:3e3,domain:function Da(e){var t=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,n=e.split(".");(4<(n=n[n.length-1]).length||"com"===n||"org"===n)&&(t=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i);var r=e.match(t);return r?r[0]:""}(window.location.hostname),pageStartTime:Er,lastUpdateTime:Er},Ir={profileId:null,pageId:null,pageviewId:null,deviceId:null,sessionId:null,vn:1,pvn:0},xr=function Pa(){return(Sr.find(function(e){return e["ptx.start"]!==undefined})||{})["ptx.start"]||Er}(),Or=function Or(){var i=yr();if(i){var a=[{key:"deviceId",type:"string"},{key:"sessionId",type:"string"},{key:"vn",type:"number"},{key:"pvn",type:"number"}];Object.keys(Ir).forEach(function(t){var e=Lr(t);"profileId"===t&&e&&ar.removeItem("ptx_".concat(e),"/");var n=a.find(function(e){return e.key===t});if(n){var r=or(i,t);r&&(e="number"===n.type?+r:r)}Ir[t]="pvn"===t?e+1:e});var e=or(i,"sact");e!==undefined&&""!==e&&Tr.lastUpdateTime-Number(e)>Tr.SILENCEDURATION&&Cr("reactivated"),Pr(),function t(){return"Safari"===function o(){var e=navigator.userAgent,t=window.ActiveXObject!==undefined&&-1!==e.indexOf("MSIE"),n=-1!==e.indexOf("Firefox"),r=window.opr!==undefined,i=-1!==e.indexOf("Chrome")&&window.chrome,a=-1!==e.indexOf("Safari")&&-1!==e.indexOf("Version");return t?"IE":n?"Firefox":r?"Opera":i?"Chrome":a?"Safari":"Unkown"}()}()&&(!function n(){wr&&wr.set(function e(){return location.host+":"+Ir.profileId}(),Ir,function(e){})}(),function o(){var t=document.createElement("iframe"),e="https:"===location.protocol?"https://":"http://";t.src=e+"js.ptengine.jp/tracking.html",t.setAttribute("style","width:0;height:0;border:0;border:none;display:none"),document.body.appendChild(t);var n=!1,r=setTimeout(function(){n||(n=!0),Wr()},1e3);function i(r,i){var n=0,a={};function o(e){var t="callback_"+n++;return a[t]=function(){e.apply(r,arguments)},t}window.addEventListener("message",function(e){if(/js(test)?\.pt(engine|mind)\.(cn|jp)/.test(e.origin)){var t=JSON.parse(e.data),n=t.fn;n&&a[n]&&"function"==typeof a[n]&&(a[n](t.result),delete a[n])}}),this.set=function(e,t,n){r.postMessage(JSON.stringify({key:e,data:t,fn:o(n)}),i)},this.get=function(e,t){r.postMessage(JSON.stringify({key:e,fn:o(t)}),i)}}t.addEventListener("load",function(e){n||(n=!0,clearTimeout(r),wr=new i(t.contentWindow,"*"),Wr())})}())}},Cr=function Cr(e){var t=Ir.vn;"reactivated"===e?(Ir.vn=t+1,Ir.pvn=1,Ir.pageId=Lr("pageId"),Ir.pageviewId=Lr("pageviewId"),Ir.sessionId=Lr("sessionId"),Ir.sact=Lr("sact")):"changePage"===e&&(Ir.pageviewId=Lr("pageviewId")),Pr()},Nr=function Nr(e,t){Tr[e]=t,Pr()},Ar=function Ar(){return["pageId","profileId","pageviewId","deviceId","sessionId"].every(function(e){return Boolean(Ir[e])})},Dr=function Dr(){return 1===Ir.vn};function Pr(){var e=Ir.profileId,t=Tr.domain;if(e){var n=Object.keys(Ir).map(function(e){var t=Ir[e];return"".concat(e,"=").concat(t,"&")});n.push("sact=".concat(Tr.lastUpdateTime)),ar.setItem("ptx_".concat(e),n.join(""),{expires:1e3},"/",t)}}function Lr(e){var t="",n=new Date,r=n.getTime()+"-"+n.getDate(),i=(location.protocol+"//"+location.host).toLowerCase()+location.pathname+location.search+location.hash;switch(e){case"pageId":t=Rr(i);break;case"profileId":t=yr();break;case"pageviewId":case"sessionId":t=function a(){var e="0123456789abcdefghijklmnopqrstuvwxyz",t=e.substr(Math.floor(Math.random()*e.length),1),n=Rr(function r(){for(var e=[],t=0;t<22;t++)e[t]="0123456789abcdefghijklmnopqrstuvwxyz".substr(Math.floor(16*Math.random()),1);return e.join("")}());return t+n.substring(1)}();break;case"deviceId":t=Rr(rr(r));break;case"vn":t=1;break;case"pvn":t=0;break;case"sact":t=Tr.lastUpdateTime}return t}function Rr(e){var t=er(e);return t&&function o(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/",n="",r=0;r<e.length/6-1;)n+=t.charAt(parseInt(e.slice(6*r,6*(r+1)),2).toString(10)),r++;var i=e.slice(6*r,6*(r+1));if(i){var a=i.length;for(r=0;r<6-a;r++)i+="0";n+=t.charAt(parseInt(i,2).toString(10))}return n}(function c(e){for(var t="",n="",r=0,i=e.length,a=0;a<i;a++){r=(n=parseInt(e.charAt(a),16).toString(2)).length;for(var o=0;o<4-r;o++)n="0"+n;t+=n}return t}(t))}function Wr(){try{window.$$__ptx_engage_$&&window.$$__ptx_engage_$.emit&&"function"==typeof window.$$__ptx_engage_$.emit&&window.$$__ptx_engage_$.emit("send.pageview")}catch(e){}}q(q.P,"String",{repeat:function(e){var t=String(z(this)),n="",r=ne(e);if(r<0||r==Infinity)throw RangeError("Count can't be negative");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}});var Mr=function(){function e(){cn(this,e)}return sn(e,[{key:"validate",value:function(){throw{name:"ImplementError",message:"validate method should be implement by "+this.constructor.name}}}]),e}(),jr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){switch(t){case"Match":return e}return!1}}]),n}(),Vr=function(e){fn(n,Mr);var t=vn(n);function n(){var e;return cn(this,n),(e=t.call(this)).currentTerminalType=cr(),e}return sn(n,[{key:"validate",value:function(e,t){switch(t){case"==":return this.currentTerminalType==e;case"!=":return this.currentTerminalType!=e}return!1}}]),n}(),Ur=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=Dr()?"NV":"RV";switch(t){case"==":return n==e;case"!=":return n!=e}return!1}}]),n}(),Fr=function(e){fn(r,Mr);var n=vn(r);function r(e){var t;return cn(this,r),(t=n.call(this)).type=e,t}return sn(r,[{key:"validate",value:function(e,t){var n=this.type,r=sr(n)||"";if(!r){var i=n.toLowerCase().split("utm");r=sr(n=0<i.length&&"utm".concat(i).replace(",","_"))||""}switch(t){case"==":return r==e;case"!=":return r!=e;case"Rex":return new RegExp(e).test(r);case"[()]":return-1!=r.indexOf(e);case"[(":return new RegExp("^"+e).test(r);case")]":return new RegExp(e+"$").test(r)}return!1}}]),r}(),Gr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n,r=document.referrer;switch(t){case"==":n=r==e;break;case"Rex":n=new RegExp(e).test(r);break;case"[()]":n=-1!=r.indexOf(e);break;case"[(":n=new RegExp("^"+r).test(e);break;case")]":n=new RegExp(r+"$").test(e);break;default:n=!1}return n}}]),n}(),Br=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n,r=location.href;switch(t){case"==":n=r==e||r.slice(0,-1)==e;break;case"Rex":n=new RegExp(e).test(r);break;case"[()]":n=-1!=r.indexOf(e);break;case"![()]":n=-1==r.indexOf(e);break;case"[(":n=new RegExp("^"+ur(e)).test(r);break;case")]":n=new RegExp(ur(e)+"$").test(r);break;default:n=!1}return n}}]),n}(),$r=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=!1;try{var r=location.href;Array.isArray(t)||(t=JSON.parse(t));for(var i=0,a=t.length;i<a;i++){var o=t[i];switch(o.pattern){case 2:n=new RegExp(o.url).test(r);break;case 3:n=new RegExp("^"+o.url).test(r);break;case 4:n=new RegExp(o.url+"$").test(r);break;case 5:n=o.url==r;break;case 8:n=-1<r.indexOf(o.url)}}}catch(c){}return n}}]),n}(),Hr=function(e){fn(n,Mr);var t=vn(n);function n(){var e;return cn(this,n),(e=t.call(this)).currentTerminalType=cr(),e}return sn(n,[{key:"validate",value:function(e,t){var n=e.context,r=n.engager,i=e.current,a=e.renderObj,o=e.container,c=e.engageWrap;e=e.value;var u=!1;"=="===t&&e&&("2"==this.currentTerminalType&&setTimeout(function(){lr(document,"mousemove",function(e){e.clientY<12&&!pr()&&(a&&o&&c?a.mounted(o,c):r.emit("next",{context:n,current:i}))})},5e3),"1"!=this.currentTerminalType&&"4"!=this.currentTerminalType||pr()||(history.replaceState("beforeunload",null,null),history.pushState("back",null,null),window.addEventListener&&window.addEventListener("popstate",function(e){"beforeunload"===e.state&&(u||(u=!0,a&&o&&c?a.mounted(o,c):r.emit("next",{context:n,current:i})))})))}}]),n}(),Jr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=e.context,r=n.engager,i=e.current,a=e.renderObj,o=e.container,c=e.engageWrap;switch(t){case"==":setTimeout(function(){a&&o&&c?a.mounted(o,c):r.emit("next",{context:n,current:i})},1e3*+e.value);break;case">=":setTimeout(function(){a&&o&&c?a.mounted(o,c):r.emit("next",{context:n,current:i})},1e3*(+e.value+1))}}}]),n}(),qr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=e.context,r=n.engager,i=e.current,a=e.renderObj,o=e.container,c=e.engageWrap,u=e.value,s=null;s=setTimeout(function(){a&&o&&c?a.mounted(o,c):r.emit("next",{context:n,current:i})},1e3*+u),lr(document,"scroll",function(){s&&(clearTimeout(s),s=null),s=setTimeout(function(){a&&o&&c?a.mounted(o,c):r.emit("next",{context:n,current:i})},1e3*+u)}),lr(document,"click",function(){s&&(clearTimeout(s),s=null),s=setTimeout(function(){a&&o&&c?a.mounted(o,c):r.emit("next",{context:n,current:i})},1e3*+u)})}}]),n}(),zr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(r,e){var i=r.context,a=i.current,o=i.engager,c=r.renderObj,u=r.container,s=r.engageWrap,l=(r=+r.value.replace("%",""),!1);lr(document,"scroll",function(){setTimeout(function(){var e=parseInt(document.body.scrollHeight,10),t=document.documentElement.scrollTop||window.pageYOffset;isNaN(t)&&(screenTop=0);var n=(parseFloat(t)+parseInt(document.documentElement.clientHeight,10))/e*100;(Math.abs(n-r)<=2||r<=n)&&!l&&(l=!0,c&&u&&s?c.mounted(u,s):o.emit("next",{context:i,current:a}))},50)})}}]),n}(),Xr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=e.context,r=e.renderObj,i=e.container,a=e.engageWrap;if("3.0"===(n.current||{}).engageVersion){var o=n.engager,c=e.current;if(c){var u=c.popupId;c.repeat=!0,c.goNext=!1,o.on("showEngage.".concat(u),function(){r&&i&&a&&r.mounted(i,a)})}}else{var s=n.current,l=n.engager,d=s.engagerId;l.on("showEngagement.".concat(d),function(){r&&i&&a?r.mounted(i,a):l.emit("next",{context:n,current:s})}),l.on("toggleEngagement.".concat(d),function(){r&&i&&a?r.mounted(i,a):(n&&(n.repeat=!0),l.emit("next",{context:n,current:s}))})}}}]),n}(),Kr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=e.context,r=e.current,i="3.0"===(n.current||{}).engageVersion?r:n.current;switch(t){case">":+JSON.parse(gr(i.popupId||i.exp_id)||"{}").seenTimes>=e.value?i.goNext=!1:i.goNext=!0}}}]),n}(),Yr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t,n){var r=e.context,i=e.current,a="3.0"===(r.current||{}).engageVersion?i:r.current,o=JSON.parse(gr(a.popupId||a.exp_id||a.currentVersionId)||"{}"),c=!o.hasClosed||+o.hasClosed<e.value;a.goNext=c,e.popup&&(e.popup.goNext=c)}}]),n}(),Zr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=e.context,r=e.current,i="3.0"===(n.current||{}).engageVersion?r:n.current;!!JSON.parse(gr(i.popupId||i.exp_id)||"{}").formSubmitted==e.value?i.goNext=!1:i.goNext=!0}}]),n}(),Qr=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=e.context,r=e.current,i="3.0"===n.current.engageVersion?r:n.current,a=JSON.parse(gr(i.popupId||i.exp_id||i.currentVersionId)||"{}"),o=null;switch(t){case"==":case"!=":o=!!a.hasClicked!=e.value}null!==o&&(e.popup&&(e.popup.goNext=o),i.goNext=o)}}]),n}(),ei=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n,r=kr.getProfileTimeStamp(),i=r||Date.now();if(i=String(i).slice(0,-3),Array.isArray(e)||(e=[e]),0<e.length){var a=e[0]?i-e[0]:"",o=e[1]?e[1]-i:"";n=o?0<=o&&0<=a:a&&0<=a}else n=!0;return n}}]),n}(),ti=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=kr.getProfileTimeStamp(),r=(n?new Date(n):new Date).getDay();return Array.isArray(e)||(e=[e]),0==e.length||7==e.length||-1<e.indexOf(r)}}]),n}(),ni=function(e){fn(n,Mr);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"validate",value:function(e,t){var n=kr.getProfileTimeStamp(),r=n?new Date(n):new Date,i=r.getHours(),a=(i=i<10?"0"+i:i)+":"+r.getMinutes();Array.isArray(e)||(e=[e]);var o=!1;if(0<e.length){var c=e[0],u=e[1];c<=a&&a<=u&&(o=!0)}else o=!0;return o}}]),n}();function ri(e){var t=_r.get(e);if(!t){switch(e){case"TerminalType":t=new Vr;break;case"VisitType":t=new Ur;break;case"utmCampaign":case"utmSource":case"utmMedium":case"utmContent":case"utmTerm":t=new Fr(e);break;case"EntryPage":t=new Gr;break;case"URL":t=new Br;break;case"PageGroup":t=new $r;break;case"UserBlur":t=new Hr;break;case"UserStay":t=new Jr;break;case"UserStop":t=new qr;break;case"ScrollMatch":t=new zr;break;case"ShownByJs":t=new Xr;break;case"UtmParameter":t=new Fr;break;case"ClickButton":t=new Qr;break;case"SeenTimes":t=new Kr;break;case"CloseTimes":t=new Yr;break;case"FormSubmitted":t=new Zr;break;case"Dater":t=new ei;break;case"Week":t=new ti;break;case"Time":t=new ni;break;case"AsyncUserProps":t=new jr}_r.set(e,t)}return t}var ii=function(){function r(e,t,n){cn(this,r),this.value=e,this.condition=t,this.validator=n}return sn(r,[{key:"setValue",value:function(e){this.value=e}},{key:"setCondition",value:function(e){this.condition=e}},{key:"setValidator",value:function(e){this.validator=e}},{key:"run",value:function(){var e;try{return this.validator.validate(this.value,this.condition)}catch(t){hr(t.name,t.message),e=!1}return e}}]),r}();function ai(e,t,n){return new ii(e,t,n)}function oi(e,t){var n=2<arguments.length&&arguments[2]!==undefined?arguments[2]:[],r=3<arguments.length?arguments[3]:undefined,i=4<arguments.length?arguments[4]:undefined;Array.isArray(n)||(n=[n]);var a=!0;if(n&&0<n.length){kr.setTimeZone(""),!i&&kr.setTimeZone(r||"");for(var o=0;o<n.length;o++){var c=n[o];if(t.setValue(c.value),t.setValidator(ri(c.type)),!t.run()){a=!1;break}}}return a}var ci={f:Object.getOwnPropertySymbols},ui=Object.assign,si=!ui||C(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=ui({},e)[n]||Object.keys(ui({},t)).join("")!=r})?function(e,t){for(var n=dt(e),r=arguments.length,i=1,a=ci.f,o=me.f;i<r;)for(var c,u=ye(arguments[i++]),s=a?Ge(u).concat(a(u)):Ge(u),l=s.length,d=0;d<l;)o.call(u,c=s[d++])&&(n[c]=u[c]);return n}:ui;q(q.S+q.F,"Object",{assign:si});var li={DATA_WIDGET_ID:"data-engage-widget-id",MASKLAYERPPREFIX:"pt_mask_",POSITION:"position"};function di(e){var t=e.querySelector("[".concat(li.DATA_WIDGET_ID,"]"));return t&&t.getAttribute(li.DATA_WIDGET_ID)||""}function fi(e,t){var n,r=_r.get(li.POSITION)||[];return(n=1==+e?!r.length:!(-1<r.indexOf(t)))&&(r[r.length]=t,_r.set(li.POSITION,r)),n}function gi(e){var t=document.querySelector(".engage-layer");t||(t=document.createElement("div")).classList.add("engage-layer");var n="".concat(li.MASKLAYERPPREFIX).concat(e),r=document.getElementsByTagName("html")[0];r.classList.add("engage-layer-open"),r.classList.add(n);var i=document.body;i.classList.add("engage-layer-open"),i.classList.add(n),i.appendChild(t)}function hi(e){var t=document.querySelector(".engage-layer");if(t){var n="".concat(li.MASKLAYERPPREFIX).concat(e),r=["engage-layer-open",n],i=document.getElementsByTagName("html")[0],a=document.body;Array.prototype.slice.call(document.body.classList).filter(function(e){return"engage-layer-open"==e||/^pt_mask_/.test(e)}).reverse().join("")==r.reverse().join("")?(a.removeChild(t),r.forEach(function(e){i.classList.remove(e),a.classList.remove(e)})):(i.classList.remove(n),a.classList.remove(n))}}function pi(e,t){var n=2<arguments.length&&arguments[2]!==undefined?arguments[2]:"view",r=3<arguments.length?arguments[3]:undefined,i=e.setting.sid||yr(),a=t.engagerId,o=t.exp_id,c=t.variant||{},u=t.triggerCondition;r&&(c=dn(dn({},c),{},{target:r})),e.send(n,{sid:i,engagerId:a,engagerVerId:o,variant:c,triggerCondition:u})}function vi(e){var t=_r.get(li.POSITION)||[],n=t.indexOf(e);-1!==n&&(t.splice(n,1),_r.set(e,t))}function mi(e){var t=e.querySelector('[data-engage-block="branding"]');if(t){var n=(t.href||"").replace(/(utm_source=)Customer-Site/,"$1"+location.hostname);t.setAttribute("href",n)}}function yi(e){var t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:"seenTimes",n=gr(e);null==n?n={seenTimes:1,hasClosed:0,hasClicked:0,formSubmitted:0,previewFormContent:null}:(n=JSON.parse(n))[t]=Number(n[t]||0)+1,fr(e,JSON.stringify(n))}function wi(e){Array.prototype.slice.call(e.querySelectorAll("script")).forEach(function(e){var t=document.createElement("script"),n="\n                try {\n                    (function(){".concat(e.innerHTML,"})();\n                } catch (error) {\n                    console.warn(error);\n                }");t.innerHTML=n;var r=document.getElementsByTagName("head")[0];r.appendChild(t),r.removeChild(t)})}function bi(e,t){var n=t&&document.querySelector("#link_"+t);n&&document.getElementsByTagName("head")[0].removeChild(n);var r=document.createElement("style");r.type="text/css",r.id="link_"+t,r.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(r)}function _i(e,r){var t=new RegExp("([^\r\n,{}]+)(,(?=[^}]*{)|s*{)","g");return e=e.replace(t,function(e,t,n){return t.match(/^\s*(@media|@.*keyframes|to|from|@font-face|1?[0-9]?[0-9])/)?t+n:(t.match(/:scope/)&&(t=t.replace(/([^\s]*):scope/,function(e,t){return""===t?"> *":"> "+t})),(t=t.replace(/^(\s*)/,"$1"+r+" "))+n)})}function ki(n,r){var i=0,a=setInterval(function(){if(i+=50,(window.analytics||1e3<i)&&(clearInterval(a),window._pt_sp_2)){var e=window.ptengine.__sid||localStorage.getItem("PTX_SID"),t=window.ptengine.__pteSid||localStorage.getItem("PTSID");e&&t&&e===t&&window._pt_sp_2.push(n,Object.assign({},r,{disablePtx:!0}))}},50)}var Ei=function(){function r(e,t,n){cn(this,r),this.context=e,this.current=t,this.terminal=null,this.currentWidgetIndex=0,this.container=null,this.engageWrap=null,this.renderList=null,this.currentWidgetConfig=null,this.callback=n,this.showMask=!1,this.config={DATA_BLOCK:"data-engage-block",DATA_WIDGET_ID:"data-engage-widget-id",DATA_SHOW_ENGAGE:"data-show-engage",DATA_GOTO_WIDGET:"data-goto-widget",DATA_ACTION_CLICK:"data-engage-action-click",DATA_ACTION_CLOSE:"data-engage-action-close",BUTTON_URL:"button-url",BUTTON_TEL:"button-tel",BUTTON_CLOSE:"button-close",BUTTON_GOTO_WIDGET:"button-goto-widget",ICON_CLOSE:"icon-close",POSITION:"position",CENTERPOSITION:"pos-center",LAYOUTMODE:"layoutMode",VISUALMODEL:"visualModel",CODEMODEL:"codeModel",MASKLAYERPPREFIX:"pt_mask_"}}return sn(r,[{key:"_getRenderList",value:function(){return this.terminal.widgets.reduce(function(e,t){var n=t.widgetNodes,r=n.html,i=n.css,a=n.script,o=void 0===a?"":a;return e.push({html:r+o,css:i}),e},[])}},{key:"_getWidget",value:function(e){return!(e<0||e>this.renderList.length-1)&&this.renderList[e]}},{key:"_getWidgetConfig",value:function(e){var t=this.terminal.widgets;return!(e<0||e>t.length-1)&&this.terminal.widgets[e]}},{key:"_gotoPrev",value:function(){var e=this.currentWidgetIndex-1;0<=e&&(this.currentWidgetIndex=e,this.render())}},{key:"_gotoNext",value:function(e){var t=this.renderList.length-1,n=this.currentWidgetIndex+1;n<=t&&(this.currentWidgetIndex=n,e&&this.currentWidgetConfig.widgetMode===this.config.VISUALMODEL&&vi(this.currentWidgetConfig.visualModel.widgetSettings.position),this.render())}},{key:"_addEventHandler",value:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}},{key:"_handleGotoWidgetClick",value:function(e){var t=e.getAttribute(this.config.DATA_GOTO_WIDGET);"prev"===t?this._gotoPrev():"next"===t&&this._gotoNext()}},{key:"_handleCloseClick",value:function(e){this._execWidgetEvent(e,"unmounted")}},{key:"_execWidgetEvent",value:function(e,t,n){window.ptEngage=window.ptEngage||{};var r=di(e),i=window.ptEngage[r]||[];0<i.length&&(i.map(function(e){e[t]&&"function"==typeof e[t]&&e[t](),n&&"function"==typeof n&&(e.callback=n)}),r&&"unmounted"===t&&delete window.ptEngage[r])}},{key:"updateState",value:function(e,t){Object.prototype.hasOwnProperty.call(this,e)&&(this[e]=t)}},{key:"triggerEvent",value:function(e,t){this._execWidgetEvent(this.engageWrap,e,t)}},{key:"_renderHtmlCssAndScript",value:function(e){var t=this._getWidget(this.currentWidgetIndex);if(t){var n=t.html,r=t.css,i='div[data-pt-engage-id="'.concat(this.currentWidgetConfig.widgetId,'"]');n=e?function a(e,t){return'<div data-pt-engage-id="'.concat(t,'">').concat(e,"</div>")}(n,this.currentWidgetConfig.widgetId):n,(r=e?_i(r,i):r)&&bi(r,this.currentWidgetConfig.widgetId),n&&(this.engageWrap.innerHTML=n),this.engageWrap.style.display="none",this.container&&this.container.appendChild(this.engageWrap),this.triggerEvent("unmounted"),wi(this.engageWrap),this.engageWrap.style.display="block",this.triggerEvent("mounted",function(e){e&&"function"==typeof e&&e(this.current.engagerId)})}}},{key:"_subscribeClickEvent",value:function(l,d,f){var g=this,h=d.current;this._addEventHandler(l,"click",function(e){for(var n=(e=e||window.event).target||e.srcElement,r=[g.config.DATA_ACTION_CLICK,g.config.DATA_ACTION_CLOSE],t=!1,i="";i=n.getAttribute(g.config.DATA_BLOCK),!(t=function(){for(var e=0,t=r.length;e<t;e++)if(n.getAttribute(r[e]))return!0}())&&(n=n.parentNode),!t&&n!=l;);if(t){e.preventDefault();var a=n.tagName.toUpperCase(),o=n.textContent||a||"unknow target";if(n.parentNode&&"image"==n.parentNode.getAttribute("data-engage-block")){var c=n.querySelector("img");c&&(o=c.getAttribute("alt"))}if(i&&(i===g.config.BUTTON_CLOSE||i===g.config.ICON_CLOSE)){l&&g.container.removeChild(l),g.showMask&&hi(g.currentWidgetConfig.widgetId),pi(g.context,g.current,"close",o),hr(),f&&"function"==typeof f&&f(g.current.exp_id,"hasClosed");try{g.currentWidgetConfig.widgetMode===g.config.VISUALMODEL&&vi(g.currentWidgetConfig.visualModel.widgetSettings.position)}catch(u){}return}if(i&&i===g.config.BUTTON_GOTO_WIDGET){try{g.currentWidgetConfig.widgetMode===g.config.VISUALMODEL&&vi(g.currentWidgetConfig.visualModel.widgetSettings.position),g.showMask&&hi(g.currentWidgetConfig.widgetId),pi(d,h,"click",o)}catch(e){}g._handleGotoWidgetClick(n)}else pi(d,h,"click",o);if(n.href&&!/^javascript:(void\(0\))?;?$/.test(n.href))if("_blank"==n.target)try{window.open(n.href,"_blank")}catch(s){hr()}else window.location.href=n.href;f&&"function"==typeof f&&f(h.exp_id)}})}},{key:"render",value:function(){var e=this._getWidgetConfig(this.currentWidgetIndex);if(this.currentWidgetConfig=e){var t=e.widgetMode!==this.config.CODEMODEL,n=e.widgetMode===this.config.LAYOUTMODE,r=n?e.widgetSettings&&e.widgetSettings.position:e.visualModel&&e.visualModel.widgetSettings&&e.visualModel.widgetSettings.position;if(t){if(!(r&&fi(this.terminal.type,r)))return;if(this._renderHtmlCssAndScript(n),!(this.engageWrap&&"false"!==this.engageWrap.getAttribute(this.config.DATA_SHOW_ENGAGE))){var i=_r.get(this.config.POSITION)||[],a=i.indexOf(r);return void(-1!==a&&(i.splice(a,1),_r.set(this.config.POSITION,i)))}}else this._renderHtmlCssAndScript(!0);if(n){var o=this.engageWrap.querySelector('[data-engage-block="engage"]');e.widgetSettings&&!e.widgetSettings.showMask?(o.style.left="auto",o.style.right="auto",o.style.top="auto",o.style.bottom="auto"):e.widgetSettings.showMask&&(o.style.position="fixed")}else(r&&r===this.config.CENTERPOSITION||this.engageWrap.querySelector("[data-pt-showmask]"))&&(this.showMask=!0,gi(e.widgetId));mi(this.engageWrap)}}},{key:"mounted",value:function(e,t){this.container=e,this.engageWrap=t,this.terminal=this.current&&this.current.currentTerminal,this.submitCallback=function(e,t){this.showMask&&hi(this.currentWidgetConfig.widgetId),pi(e,t,"submit"),yi(t.exp_id,"formSubmitted")},this.updateRenderedPositionCache=vi,this.renderList=this._getRenderList(),this.render(),window.ptEngage=window.ptEngage||{},window.ptEngage&&(window.ptEngage[this.current.engagerId]=this),this._subscribeClickEvent(this.engageWrap,this.context,function(e){yi(e,1<arguments.length&&arguments[1]!==undefined?arguments[1]:"hasClicked")}),this.callback&&"function"==typeof this.callback&&this.callback()}},{key:"unmounted",value:function(){}}]),r}(),Si=function(){function n(e,t){cn(this,n),this.inline=e,this.callback=t,this.modeTags={REPLACE:0,INSERT:1,APPEND:2,BEFORE:3,AFTER:4},this.docmentFirstCSSStyleSheet=null}return sn(n,[{key:"_selector",value:function(e){return e&&document.querySelector(e)}},{key:"_getFirstCSSStyleSheet",value:function(e){if(this.docmentFirstCSSStyleSheet)return this.docmentFirstCSSStyleSheet;for(var t=e.styleSheets.length-1;0<=t;t--){var n=e.styleSheets[t];if(!n.href){var r=n.ownerNode;if(r&&r.parentNode&&"HEAD"===r.parentNode.tagName)return this.docmentFirstCSSStyleSheet=n}}return 0===e.styleSheets.length&&e.createStyleSheet(),this.docmentFirstCSSStyleSheet=e.styleSheets[0]}},{key:"_getNewStyleSheet",value:function(e,t){var n=(t||document).createElement("style");return n.cssText!==undefined?n.cssText=e:n.innerHTML=e,n}},{key:"_addStyleSheetToHead",value:function(e,t){var n=t||document,r=n.getElementsByTagName("head")[0];r||(r=n.createElement("head"),n.body.parentNode.insertBefore(r,n.body)),r.appendChild(e)}},{key:"_addStyleSheet",value:function(e,t,n,r,i){var a=e+"{"+t+": "+n+(r?" !important":"")+"}";if(i&&(a=i+"{"+a+"}"),document.createStyleSheet){var o=this._getFirstCSSStyleSheet(document),c=o.rules.length;return o.insertRule(a,c),function(){o.deleteRule?o.deleteRule(c):o.removeRule(c),o.insertRule("x {}",c)}}var u=this._getNewStyleSheet(a,document);this._addStyleSheetToHead(u,document);var s=u.parentNode;return function(){s.removeChild(u)}}},{key:"_setStyleProperty",value:function(e,t,n,r){if(e.style.setProperty)try{var i=e.style.getPropertyValue(t),a=e.style.getPropertyPriority(t);return e.style.setProperty(t,n,r?"important":""),function(){e.style.setProperty(t,"",a),e.style.setProperty(t,i,a)}}catch(c){}var o=e.style.cssText;return e.style.cssText+=";"+t+": "+n+(r?" !important":"")+";",function(){e.style.cssText=o}}},{key:"_setAttribute",value:function(e,t,n){try{null===n?e.removeAttribute(t):e.setAttribute(t,n)}catch(r){return r}return null}},{key:"_updateText",value:function(e){var t=e.elementText,n=(e.type,t.selector),r=t.text,i=t.childIndex,a=this._selector(n.string);if(a&&0<=i.integer&&i.integer<a.childNodes.length){var o=a.childNodes[i.integer];null!=o&&o.nodeType==Node.TEXT_NODE&&(o.nodeValue=r.string)}}},{key:"_updateContent",value:function(e,t){var n=e.elementContent,r=n.selector,i=n.html,a=this._selector(r.string);if(a){var o,c,u=a.ownerDocument||a.document||document;switch(t=(t||"").toLowerCase()){case"after":o=a.parentNode,c=a.nextSibling;break;case"insert":c=(o=a).firstChild;break;case"append":o=a,c=null;break;default:o=a.parentNode,c=a}if(!o||o===u)return{result:1,Sg:[]};var s=this._getNewNode(i.string,o);if(this._removeNode(s,"SCRIPT"),this._removeNode(s,"NOSCRIPT"),s.firstChild)for(var l=s.firstChild;l;){var d=l.nextSibling;o.insertBefore(l,c),l=d}"replace"===t&&o.removeChild(a)}}},{key:"_getNewNode",value:function(e,t){var n=t.ownerDocument.createElement("div");return n.innerHTML=e||"",n}},{key:"_removeNode",value:function(e,t){for(var n=e.getElementsByTagName(t),r=[],i=n.length-1;0<=i;i--){var a=n[i];a.parentNode.removeChild(a),r.push(a)}}},{key:"_updateStyle",value:function(e){var t=e.elementStyle,n=(e.type,t.property),r=t.value,i=t.selector,a=t.cssRule,o=t.important,c=t.cssConditional,u=n&&n.string,s=r&&r.string,l=o&&o["boolean"],d=i&&i.string,f=c&&c.string;if(d)if(a)this._addStyleSheet(d,u,s,l,f);else{var g=document.querySelector(d);g&&this._setStyleProperty(g,u,s,l)}}},{key:"_updateAttribute",value:function(e){var t=e.changeElementAttribute,n=t.attribute,r=t.value,i=t.selector,a=n&&n.string,o=r&&r.string,c=i&&i.string;if(c&&document.documentElement.setAttribute){var u=document.querySelector(c);u&&this._setAttribute(u,a,o)}}},{key:"mounted",value:function(){var t=this,e=this.inline||{},n=e.changeElementAttribute,r=e.elementText,i=e.elementStyle,a=e.elementContent;if(i)this._updateStyle(this.inline);else if(n)this._updateAttribute(this.inline);else{var o=(r||a||{}).mode,c=Object.keys(this.modeTags).find(function(e){return t.modeTags[e]===o});a?this._updateContent(this.inline,c):r&&this._updateText(this.inline,c)}this.callback()}}]),n}();function Ti(e){return/\S+@\S+\.\S+/.test(e)}function Ii(e){return e&&/^[0-9_-]+$/.test(e)}var xi=function xi(){return"undefined"==typeof window},Oi=function Oi(e){e=e||navigator.userAgent;var t=/(iPad).*OS\s([\d_]+)/.test(e);return{ios:!t&&/(iPhone\sOS)\s([\d_]+)/.test(e)||t,android:/(Android);?[\s/]+([\d.]+)?/.test(e)}};var Ci=0,Ni=0,Ai=0,Di=null,Pi=!1,Li=[],Ri=function La(e){if(xi())return!1;if(!e)throw new Error("options must be provided");var t=!1,n={get passive(){t=!0}},r=function r(){},i="__TUA_BSL_TEST_PASSIVE__";window.addEventListener(i,r,n),window.removeEventListener(i,r,n);var a=e.capture;return t?e:void 0!==a&&a}({passive:!1}),Wi=function Wi(){var t=document.body,n=Object.assign({},t.style),e=window.innerWidth-t.clientWidth;return t.style.overflow="hidden",t.style.boxSizing="border-box",t.style.paddingRight="".concat(e,"px"),function(){["overflow","boxSizing","paddingRight"].forEach(function(e){t.style[e]=n[e]||""})}},Mi=function Mi(){var e=document.documentElement,t=document.body,n=e.scrollTop||t.scrollTop,r=Object.assign({},e.style),i=Object.assign({},t.style);return e.style.height="100%",e.style.overflow="hidden",t.style.top="-".concat(n,"px"),t.style.width="100%",t.style.height="auto",t.style.position="fixed",t.style.overflow="hidden",function(){e.style.height=r.height||"",e.style.overflow=r.overflow||"",["top","width","height","overflow","position"].forEach(function(e){t.style[e]=i[e]||""}),window.scrollTo(0,n)}},ji=function ji(e){e.cancelable&&e.preventDefault()},Vi=function Vi(e,t){if(t){var n=t.scrollTop,r=t.scrollLeft,i=t.scrollWidth,a=t.scrollHeight,o=t.clientWidth,c=t.clientHeight,u=e.targetTouches[0].clientX-Ai,s=e.targetTouches[0].clientY-Ni,l=Math.abs(s)>Math.abs(u);if(l&&(0<s&&0===n||s<0&&a<=n+c+1)||!l&&(0<u&&0===r||u<0&&i<=r+o+1))return ji(e)}return e.stopPropagation(),!0},Ui=function Ui(e){e||null!==e&&process.env.NODE_ENV},Fi=function Fi(e){if(!xi()){if(Ui(e),Oi().ios){if(e)(Array.isArray(e)?e:[e]).forEach(function(t){t&&-1===Li.indexOf(t)&&(t.ontouchstart=function(e){Ni=e.targetTouches[0].clientY,Ai=e.targetTouches[0].clientX},t.ontouchmove=function(e){1===e.targetTouches.length&&Vi(e,t)},Li.push(t))});Pi||(document.addEventListener("touchmove",ji,Ri),Pi=!0)}else Ci<=0&&(Di=Oi().android?Mi():Wi());Ci+=1}},Gi=function Gi(){if(!xi())if(Ci=0,Oi().ios||"function"!=typeof Di){if(Li.length)for(var e=Li.pop();e;)e.ontouchmove=null,e.ontouchstart=null,e=Li.pop();Pi&&(document.removeEventListener("touchmove",ji,Ri),Pi=!1)}else Di()},Bi=function(){function u(e,t,n,r,i,a,o){cn(this,u);var c=n.widgets;this.engageId=e,this.popup=n,this.terminalType=t,this.widgets=c||[],this.context=r,this.current=i,this.currentWidgetIndex=0,this.container=null,this.engageWrap=null,this.renderList=null,this.currentWidgetConfig=null,this.isPreview=a,this.callback=o,this.showMask=!1,this.validate=ai(),this.config={DATA_BLOCK:"data-engage-block",DATA_WIDGET_ID:"data-engage-widget-id",DATA_SHOW_ENGAGE:"data-show-engage",DATA_GOTO_WIDGET:"data-goto-widget",DATA_BUTTON_TYPE:"data-button-type",BUTTON_FORM_SUBMIT:"button-submit-success",DATA_ACTION_CLICK:"data-engage-action-click",DATA_ACTION_CLOSE:"data-engage-action-close",DATA_NO_PACKAGE:"data-engage-no-package",BUTTON_URL:"button-url",BUTTON_TEL:"button-tel",BUTTON_CLOSE:"button-close",BUTTON_GOTO_WIDGET:"button-goto-widget",ICON_CLOSE:"icon-close",POSITION:"position",CENTERPOSITION:"pos-center",LAYOUTMODE:"layoutMode",MASKLAYERPPREFIX:"pt_mask_"}}return sn(u,[{key:"_getRenderList",value:function(){return this.widgets.reduce(function(e,t){var n=t.widgetNodes,r=n.html,i=n.css,a=n.script,o=void 0===a?"":a;return e.push({html:r+o,css:i}),e},[])}},{key:"_getWidget",value:function(e){return!(e<0||e>this.renderList.length-1)&&this.renderList[e]}},{key:"_getWidgetConfig",value:function(e){return!(e<0||e>this.widgets.length-1)&&this.widgets[e]}},{key:"_gotoPrev",value:function(){var e=this.currentWidgetIndex-1;0<=e&&(this.currentWidgetIndex=e,this.render())}},{key:"_gotoNext",value:function(e){var t=this.renderList.length-1,n=this.currentWidgetIndex+1;if(n<=t){if(this.currentWidgetIndex=n,e)try{vi(this.currentWidgetConfig.widgetSettings.position)}catch(r){}this.render()}}},{key:"_addEventHandler",value:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}},{key:"_removeEventHandler",value:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}},{key:"_handleGotoWidgetClick",value:function(e){var t=e.getAttribute(this.config.DATA_GOTO_WIDGET);"prev"===t?this._gotoPrev():"next"===t&&this._gotoNext(!0)}},{key:"_handleCloseClick",value:function(e){this._execWidgetEvent(e,"unmounted")}},{key:"_execWidgetEvent",value:function(e,t,n){window.ptEngage=window.ptEngage||{};var r=di(e),i=window.ptEngage[r]||[];0<i.length&&(i.map(function(e){e[t]&&"function"==typeof e[t]&&e[t](),n&&"function"==typeof n&&(e.callback=n)}),r&&"unmounted"===t&&delete window.ptEngage[r])}},{key:"updateState",value:function(e,t){Object.prototype.hasOwnProperty.call(this,e)&&(this[e]=t)}},{key:"triggerEvent",value:function(e,t){this._execWidgetEvent(this.engageWrap,e,t)}},{key:"_renderHtmlCssAndScript",value:function(){var e=this._getWidget(this.currentWidgetIndex);if(e){var t=e.html,n=e.css;(n=_i(n,"#engage_".concat(this.popup.popupId)))&&bi(n,this.currentWidgetConfig.widgetId),t&&(this.engageWrap.innerHTML=t),this.engageWrap.style.display="none",this.container&&this.container.appendChild(this.engageWrap),this.triggerEvent("unmounted"),wi(this.engageWrap),this.engageWrap.style.display="block",this.triggerEvent("mounted",function(e){e&&"function"==typeof e&&e(this.engageId)})}}},{key:"_handlePopupClick",value:function(e,t,n,r){for(var i=this,a=e.target||e.srcElement,o=[this.config.DATA_ACTION_CLICK,this.config.DATA_ACTION_CLOSE],c=!1,u="",s="";u=a.getAttribute(this.config.DATA_BLOCK),s=a.getAttribute(this.config.DATA_BUTTON_TYPE),!(c=function(){for(var e=0,t=o.length;e<t;e++)if(a.getAttribute(o[e]))return!0}())&&(a=a.parentNode),!c&&a!=t;);if(c){e.preventDefault();var l=a.tagName.toUpperCase(),d=a.textContent||l||"unknow target";if(a.parentNode&&"image"===a.parentNode.getAttribute("data-engage-block")){var f=a.querySelector("img");f&&(d=f.getAttribute("alt"))}if(u&&(u===this.config.BUTTON_CLOSE||u===this.config.ICON_CLOSE)){t&&this.container&&this.container.hasChildNodes()&&this.container.removeChild(t),this.showMask&&(hi(this.currentWidgetConfig.widgetId),Gi());var g=a.getAttribute(this.config.DATA_NO_PACKAGE);this.isPreview||g||pi(this.context,this.current,"close",d),hr(),r&&"function"==typeof r&&r(this.popup.popupId,"hasClosed");try{this.popup.repeat&&vi(this.currentWidgetConfig.widgetSettings.position)}catch(e){}return}if(u&&u===this.config.BUTTON_GOTO_WIDGET){try{this.popup.repeat&&vi(this.currentWidgetConfig.widgetSettings.position),this.showMask&&hi(this.currentWidgetConfig.widgetId),this.isPreview||pi(n,this.current,"click",d)}catch(e){}this._handleGotoWidgetClick(a)}else u&&u===this.config.BUTTON_FORM_SUBMIT?this._handleFormSubmit(t,function(){i._handleGotoWidgetClick(a),yi(i.popup.popupId,"formSubmitted")}):this.isPreview||pi(n,this.current,"click",d);if(a.href&&!/^javascript:(void\(0\))?;?$/.test(a.href))if("submit"===s)this._handleFormSubmit(t,function(){if(yi(i.popup.popupId,"formSubmitted"),"_blank"===a.target)try{window.open(a.href,"_blank")}catch(e){hr()}else window.location.href=a.href});else if("_blank"===a.target)try{window.open(a.href,"_blank")}catch(h){hr()}else window.location.href=a.href;r&&"function"==typeof r&&r(this.popup.popupId)}}},{key:"_handleFormSubmit",value:function(e,r){e.querySelector("form");for(var t,n=e.querySelectorAll('[data-menu-action="insert.field"]'),i=[],a=[],o=!1,c=!1,u=0;u<n.length;u++){var s=n[u].getAttribute("data-field-id"),l=n[u].querySelector(".control input, .control textarea, .control select"),d=l.value,f=n[u].getAttribute("data-ptx-componentid"),g=JSON.parse(l&&l.getAttribute("data-ptx-validators")),h=l&&l.getAttribute("data-ptx-property"),p=!1,v=n[u].querySelector(".error");v&&(v.classList=["error"]),g&&!g.allowDuplicate&&(c=!0),g&&g.required?(t=d)&&""!==t?("email"!==f||Ti(d)||(p="email_fail",v.classList.add(p)),"phone"!==f||Ii(d)||(p="phone_fail",v.classList.add(p))):(p="required_fail",v.classList.add("required")):d&&""!==d&&("email"!==f||Ti(d)||(p="email_fail",v.classList.add(p)),"phone"!==f||Ii(d)||(p="phone_fail",v.classList.add(p))),p&&v&&(o=!0),i.push({fieldID:n[u].getAttribute("data-field-id"),fieldValue:d,fieldName:n[u].querySelector(".label").innerText,fieldType:f}),a.push({fieldID:s,fieldName:n[u].querySelector(".label").innerText,alowDuplicate:g.allowDuplicate,allowConnect:!!g.allowConnect,connectProperty:h||"",fieldValue:d,error:p,errorDom:v})}if(c){var m=a.filter(function(e){return!e.alowDuplicate&&e.fieldValue&&""!==e.fieldValue});m=m&&m.map(function(e){return{fieldID:e.fieldID,fieldValue:e.fieldValue}});var y=this.context,w=this.current,b=this.popup.popupId,_=this.isPreview,k={url:"https://xbackend.ptengine.jp/formVerification",method:"POST",async:!1,contentType:"application/json",data:JSON.stringify({field:m,sid:Ir.profileId,engageID:this.engageId,engageVersion:this.current.exp_id,configVerion:"3.0",creativeID:this.popup.popupId}),callback:function(e){if((e=JSON.parse(e))&&"success"===e.status){var n=e.data;if(a.forEach(function(e,t){n[e.fieldID]!==undefined&&(e.error||!0!=!n[e.fieldID]||(e.error="error_duplicate",e.errorDom.classList=["error allow-duplicate"],o=!0))}),o)return;w.variant={formContent:JSON.stringify(i),fieldIDList:JSON.stringify(a),creativeID:b},pi(y,w,"submit"),r&&"function"==typeof r&&r();var t={};a.forEach(function(e){e.connectProperty&&(t[e.connectProperty]=e.fieldValue)}),"{}"!==JSON.stringify(t)&&ptengine&&ptengine.identify&&ptengine.identify("",t,"engage")}}};if(_){var E=this._checkPreviewForm(b,m);a.forEach(function(e,t){E[e.fieldID]!==undefined&&(e.error||!0!=!E[e.fieldID]||(e.error="error_duplicate",e.errorDom.classList=["error allow-duplicate"],o=!0))}),o||(function x(e,t){var n=gr(e);if(null==n)n={seenTimes:1,hasClosed:0,hasClicked:0,formSubmitted:0,previewFormContent:null};else{var r=(n=JSON.parse(n)).previewFormContent;r?r.concat(t):r=t,n.previewFormContent=r,fr(e,JSON.stringify(n))}}(b,i),r&&"function"==typeof r&&r())}else tr(k)}else{if(o)return;var S=this.context,T=this.current;T.variant={formContent:JSON.stringify(i),fieldIDList:JSON.stringify(a),creativeID:this.popup.popupId};var I={};a.forEach(function(e){e.connectProperty&&(I[e.connectProperty]=e.fieldValue)}),"{}"!==JSON.stringify(I)&&ptengine&&ptengine.identify&&ptengine.identify("",I,"engage"),this.isPreview&&yi(this.popup.popupid,"previewFormContent",JSON.stringify(i)),this.isPreview||pi(S,T,"submit")}!c&&r&&"function"==typeof r&&r()}},{key:"_checkPreviewForm",value:function(e,t){return function a(e,t){var n=gr(e),r={};if(t.forEach(function(e){r[e.fieldID]=!0}),!n)return r;var i=(n=JSON.parse(n)).previewFormContent;return i&&t.forEach(function(e){var t=e.fieldID,n=e.fieldValue;r[e.fieldID]=!i.some(function(e){return e.fieldID===t&&e.fieldValue===n})}),r}(e,t)}},{key:"_checkPopupStopTrigger",value:function(e,t,n,r,i,a){for(var o=n.trigger.stop||[],c=0;c<o.length;c++){var u=o[c];if(t.setValue({value:u.value,current:n,context:e,container:r,engageWrap:i,renderObj:a}),t.setCondition(u.condition),t.setValidator(ri(u.type)),t.run(),!n.goNext)return!0}return!1}},{key:"render",value:function(){var e=this._getWidgetConfig(this.currentWidgetIndex);if(this.currentWidgetConfig=e){var t=e.widgetSettings&&e.widgetSettings.position;if(!(t&&fi(this.terminalType,t)))return;if(this._renderHtmlCssAndScript(),this.renderAfter(),!(this.engageWrap&&"false"!==this.engageWrap.getAttribute(this.config.DATA_SHOW_ENGAGE))){var n=_r.get(this.config.POSITION)||[],r=n.indexOf(t);return void(-1!==r&&(n.splice(r,1),_r.set(this.config.POSITION,n)))}var i=this.engageWrap.querySelector('[data-engage-block="engage"]');i&&(e.widgetSettings&&!e.widgetSettings.showMask?(i.style.left="auto",i.style.right="auto",i.style.top="auto",i.style.bottom="auto"):e.widgetSettings.showMask&&(this.showMask=!0,i.style.position="fixed",Fi(null))),mi(this.engageWrap)}}},{key:"renderAfter",value:function(){var n=this;window.ptEngage=window.ptEngage||{},window.ptEngage&&(window.ptEngage[this.engageId]=this);var r=function r(e){n._handlePopupClick(e,n.engageWrap,n.context,function(e){var t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:"hasClicked";yi(e,t),"hasClosed"===t&&n._removeEventHandler(n.engageWrap,"click",r)})};this._addEventHandler(this.engageWrap,"click",r),this.callback&&"function"==typeof this.callback&&this.callback()}},{key:"mounted",value:function(e,t){var n=this;this.container=e,this.engageWrap=t,this.popup.repeat&&this._checkPopupStopTrigger({current:this.current},this.validate,this.popup,e,t,this)||(this.submitCallback=function(e,t){n.showMask&&hi(n.currentWidgetConfig.widgetId),n.isPreview||pi(e,t,"submit"),yi(n.popup.popupId,"formSubmitted")},this.renderList=this._getRenderList(),this.render())}},{key:"unmounted",value:function(){}}]),u}(),$i=function(){function r(e,t,n){cn(this,r),this.type=e,this.code=t,this.callback=n}return sn(r,[{key:"_getDocHead",value:function(){var e=document.getElementsByTagName("head")[0];return e||(e=document.createElement("head"),document.body.parentNode.insertBefore(e,document.body)),e}},{key:"_createStyleElement",value:function(e){var t=document.createElement("style");return t.cssText!==undefined?t.cssText=e:t.innerHTML=e,t}},{key:"_createScriptElement",value:function(e){var t=null,n=null;try{t=new Function("element",e)}catch(r){n=r}return{jsJd:t,jsError:n}}},{key:"_attachElementToHead",value:function(e){this._getDocHead().appendChild(e)}},{key:"_addStyle",value:function(e){var t=this._createStyleElement(e);this._attachElementToHead(t)}},{key:"_runScript",value:function(e){var t=this._getDocHead(),n=this._createScriptElement(e),r=n.jsJd;n.jsError;if(r)try{r(t)}catch(i){}}},{key:"mounted",value:function(){switch(this.type){case"css":this._addStyle(this.code);break;case"javascript":this._runScript(this.code)}this.callback&&this.callback()}}]),r}(),Hi=function(){function i(e,t,n,r){cn(this,i),this.context=e,this.engage=t,this.terminalType=n,this.callback=r,this.currentVersion=null,this.currentTerminal=null,this.isPreview=t.isPreview,this.inlineIsRendered=!1,this.isSendVersionEvent=!1,this.config={CONTAINERID:"ptxEngage",currentRenderInstance:null},this.isPreview?this.renderPreview(t):this.mounted()}return sn(i,[{key:"_sendVersionEvent",value:function(){if(!this.isSendVersionEvent){this.isSendVersionEvent=!0;var e=this.engage,t=e.engageId,n=e.engageName,r=this.currentVersion||{},i=r.versionId,a=r.versionName;i&&ki("setAbtest",{category:"ptx_heatmap",expName:n,expId:t,verName:a,verId:i})}}},{key:"_getTerminalInfo",value:function(e,t){for(var n=null,r=0,i=e.length;r<i;r++)if(e[r].type===t){n=e[r];break}return n}},{key:"_createEngageWrap",value:function(e){var t=document.getElementById(e);return t||(t=document.createElement("div")).setAttribute("id",e),t}},{key:"_getEngageWrapperId",value:function(e){return"engage_"+e}},{key:"_getEngageContainerWrapper",value:function(){var e=0<arguments.length&&arguments[0]!==undefined?arguments[0]:"",t=document.getElementById(this.config.CONTAINERID);return t||((t=document.createElement("div")).setAttribute("id",this.config.CONTAINERID+"_"+e),document.body.appendChild(t)),t}},{key:"_checkPopupTrigger",value:function(e,t,n,r,i,a){var o=this.engage,c=o.triggerFlag,u=o.heatmapVersion,s=!1,l=["start"];(c||this.isPreview)&&!u&&l.unshift("stop");for(var d=0;d<l.length;d++){for(var f=l[d],g=n.trigger[f]||[],h=0;h<g.length;h++){var p=g[h];if(t.setValue({value:p.value,current:n,context:e,container:r,engageWrap:i,renderObj:a}),t.setCondition(p.condition),t.setValidator(ri(p.type)),t.run(),"stop"===f&&!n.goNext){s=!0;break}}if(s)break}s||0!==(n.trigger.start||[]).length||(hr(),a.mounted(r,i))}},{key:"_renderPopup",value:function(){var c=this,e=0<arguments.length&&arguments[0]!==undefined?arguments[0]:[],u=this.engage.engageId,s=this.currentVersion.versionId;e.forEach(function(e){var t=e.popupId,n=ai(),r=c._getEngageContainerWrapper(t),i=c._createEngageWrap(c._getEngageWrapperId(t)),a=Object.assign({},c.engage,{engagerId:u,exp_id:s,variant:{creativeId:t,creativeType:"popup"}}),o=new Bi(u,c.terminalType,e,c.context,a,c.isPreview,function(){e.renderFinish&&!e.repeat||(e.renderFinish=!0,yi(t),c.isPreview||(c._sendVersionEvent(),pi(c.context,a,"view")))});c._checkPopupTrigger(c.context,n,e,r,i,o)})}},{key:"_renderInline",value:function(){(0<arguments.length&&arguments[0]!==undefined?arguments[0]:[]).forEach(function(e){new Si(e,function(){e.renderFinish=!0}).mounted()})}},{key:"_renderCode",value:function(){(0<arguments.length&&arguments[0]!==undefined?arguments[0]:[]).forEach(function(e){new $i(e.type,e.code,function(){e.renderFinish=!0}).mounted()})}},{key:"_renderCampaign",value:function(e){var t=this,n=e||{},r=n.popup,i=n.stickybar,a=n.inline,o=n.code;if(r&&this._renderPopup(r),i&&this._renderPopup(i),o&&this._renderCode(o),Boolean(a)){var c=function c(e){t.inlineIsRendered||(t.inlineIsRendered=!0,t._renderInline(a))};"complete"===document.readyState?c():(lr(document,"DOMContentLoaded",c),lr(window,"load",c))}}},{key:"_bodyReady",value:function(e){var t=this;null===document.body?lr(window,"load",function(){return t._renderCampaign(e)}):this._renderCampaign(e)}},{key:"renderPreview",value:function(e){var t=e||{},n=t.version,r=t.terminal;this.currentVersion=n,this.currentTerminal=r,this._bodyReady(r),this.callback&&"function"==typeof this.callback&&this.callback()}},{key:"mounted",value:function(){var e=this.engage,t=e.versions,n=e.currentVersionId,r=(t||[]).find(function(e){return e.versionId===n});if(this.currentVersion=r){var i=r.terminals,a=r.controlGroup,o=r.versionId,c=Object.assign({},this.engage,{engagerId:this.engage.engageId,exp_id:o});if(a)return this._sendVersionEvent(),pi(this.context,c,"view"),yi(n),void(this.callback&&"function"==typeof this.callback&&this.callback());var u=(i||[])[0],s=u||{},l=(s.terminalStatus,s.popup),d=s.stickybar;if(!u&&!window.PT_ENGAGE_IN_DEBUG)return this.unmounted(),void(this.callback&&"function"==typeof this.callback&&this.callback());this.currentTerminal=u,this._bodyReady(u),0<[].concat(yn(l||[]),yn(d||[])).length||(this._sendVersionEvent(),pi(this.context,c,"view"),yi(n))}this.callback&&"function"==typeof this.callback&&this.callback()}},{key:"unmounted",value:function(){}}]),i}(),Ji="position",qi="pos-center",zi="ptxEngage",Xi=2147483647,Ki="button-close",Yi="icon-close",Zi=cr(),Qi=1,ea=function ea(l,d,f){var g=d.current;lr(l,"click",function(e){for(var n=(e=e||window.event).target||e.srcElement,r=["data-engage-action-click","data-engage-action-close"],t=!1,i="";i=n.getAttribute("data-engage-block"),!(t=function(){for(var e=0,t=r.length;e<t;e++)if(n.getAttribute(r[e]))return!0}())&&(n=n.parentNode),!t&&n!=l;);if(t){e.preventDefault();var a=n.tagName.toUpperCase(),o=n.textContent||a||"unknow target";if(n.parentNode&&"image"==n.parentNode.getAttribute("data-engage-block")){var c=n.querySelector("img");c&&(o=c.getAttribute("alt"))}if(i&&(i==Yi||i==Ki)){oa(l,"unmounted"),la().removeChild(l),g.shouldCreateMaskLayer&&hi(g.engagerId),pi(d,g,"close",o),hr(),f&&"function"==typeof f&&f(g.exp_id,"hasClosed");try{!g.currentTerminal.codeMode&&vi(g.currentTerminal.visualModel.widgetSettings.position)}catch(u){vr("RenderError",u)}return}if(pi(d,g,"click",o),n.href&&!/^javascript:(void\(0\))?;?$/.test(n.href))if("_blank"==n.target)try{window.open(n.href,"_blank")}catch(s){hr(),vr("WindowOpenError",s)}else location.href=n.href;f&&"function"==typeof f&&f(g.exp_id)}})},ta=function ta(e,t){var n=2<arguments.length&&arguments[2]!==undefined&&arguments[2],r=e.current,i=r.currentTerminal,a=i&&i.visualModel&&i.visualModel.widgetSettings,o=n?i.codeSync:i.visualModel.widgetNodes,c=da(fa(r.engagerId));if(c.innerHTML=sa(o,r.engagerId),c.style.display="none",la().appendChild(c),oa(c,"unmounted"),wi(c),oa(c,"mounted",function(e){e&&"function"==typeof e&&e(r.engagerId)}),c.style.display="block",c&&"false"!==c.getAttribute("data-show-engage")){i&&(a&&a.position==qi&&(gi(r.engagerId),e.current.shouldCreateMaskLayer=!0),mi(c)),ea(c,e,function(e){return yi(e,1<arguments.length&&arguments[1]!==undefined?arguments[1]:"hasClicked")}),Qi=1;var u=c.querySelectorAll("img");Array.prototype.slice.call(u).forEach(function(e){lr(e,"load",function(){e.style.opacity="1",e.style.visibility="visible"})}),t&&"function"==typeof t&&t()}else{var s=_r.get(Ji)||[],l=a&&a.position,d=s.indexOf(l);-1!==d&&(s.splice(d,1),_r.set(Ji,s))}};function na(e){if("string"==typeof e||"number"==typeof e){if(-1!=e.indexOf("<")&&/<?\/[a-z]*>/.test(e)){var t=document.createElement("div");return t.innerHTML=e,t}return document.createTextNode(e)}var n,r;1==Qi&&"a"==e.tag?(n=document.createElement("div"),(r=e.props).hasOwnProperty("href")&&delete r.href):(n=document.createElement(e.tag),r=e.props),Qi++,function a(e,t){for(var n in t)e.setAttribute(n,t[n])}(n,r);var i=e.children;return i&&i.map(na).forEach(n.appendChild.bind(n)),n}var ra=function ra(e){var t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:function(){};return hr(),t()},ia=function ia(e){var t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:function(){};e.current;return hr(),t()};function aa(e){hr();var t=e.context||e;t.current=e.current;var n=t.current,o=function o(r,i){var a=!(2<arguments.length&&arguments[2]!==undefined)||arguments[2];return function(){var e=i.currentVersionId,t=i.exp_id,n=e||t;r.repeat||_r.set(n,n),a&&(pi(r,i,"view"),yi(n))}},r=n.currentVersionId,i=n.exp_id;if(!_r.get(r||i)){if(n.controlGroup)return hr(),void ia(t,o(t,n));if(hr(),"3.0"!==n.engageVersion){var a=n.terminal&&function h(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].type==e)return t[n];return t[0]}(Zi,n.terminal),c=n.defaultOptions||a;if(!a||(n.currentTerminal=a).status||window.PT_ENGAGE_IN_DEBUG)if(n.currentTerminal&&n.isOriginalVersion)ra(t,o(t,n));else try{var u=n.currentTerminal||{},s=u.visualModel,l=u.widgets;if(l&&Array.isArray(l)&&0<l.length){var d=da(fa(n.engagerId)),f=la();new Ei(t,n,o(t,n)).mounted(f,d)}else if(s&&s.widgetSettings)if(n.currentTerminal.codeMode){var g=n.currentTerminal.codeSync.html;g&&/data-engage-block/i.test(g)?ta(t,o(t,n),!0):ca(t,o(t,n))}else fi(Zi,s.widgetSettings.position)&&ta(t,o(t,n));else n.currentTerminal.codeMode?ca(t,o(t,n)):fi(Zi,c.position||c.commonSync.position)&&function p(e,t){var n=e.current,r=n.currentTerminal.nodes,i=da(fa(n.engagerId)),a=la(),o=na(r);i.appendChild(o),a.appendChild(i);var c=n.currentTerminal;if(c){c.commonSync.position==qi&&(gi(n.engagerId),e.current.shouldCreateMaskLayer=!0);var u=i.querySelector(".js-engage-promotion-branding,.engage-promotion__friendLink,.engage-friendLink");if(u)if(c.commonSync.branding){u.style.display="block";var s=(u.href||"").replace(/(utm_source=)Customer-Site/,"$1"+location.hostname);u.setAttribute("href",s)}else u.style.display="none"}ua(i,e,function(e){return yi(e,1<arguments.length&&arguments[1]!==undefined?arguments[1]:"hasClicked")}),Qi=1;var l=i.querySelectorAll("img");Array.prototype.slice.call(l).forEach(function(e){lr(e,"load",function(){e.style.opacity="1",e.style.visibility="visible"})}),t&&"function"==typeof t&&t()}(t,o(t,n))}catch(v){vr("RenderError",v)}else hr(a.status)}else new Hi(t,n,Zi,o(t,n,!1))}}function oa(e,t,n){window.ptEngage=window.ptEngage||{};var r=di(e),i=window.ptEngage[r]||[];0<i.length&&(i.map(function(e){e[t]&&"function"==typeof e[t]&&e[t](),n&&"function"==typeof n&&(e.callback=n)}),r&&"unmounted"===t&&delete window.ptEngage[r])}function ca(e,t){var n=e.current,r=da(fa(n.engagerId)),i=la();r.innerHTML=sa(n.currentTerminal.codeSync,n.engagerId),i.appendChild(r),wi(r);var a=!!r.querySelector("[data-pt-showmask]");if(e.current.shouldCreateMaskLayer=a){gi(n.engagerId);var o=r.querySelector(".engage-promo__v-common");if(o)o.style.zIndex=Xi;else{var c=r.querySelector("[data-pt-engage-id]");c&&(c.style.zIndex=Xi)}}ua(r,e,function(e){return yi(e,1<arguments.length&&arguments[1]!==undefined?arguments[1]:"hasClicked")}),t&&"function"==typeof t&&t()}function ua(f,g,h){var p=g.current;lr(f,"click",function(e){for(var t,n=(e=e||window.event).target||e.srcElement,r=["js-engage-interaction","js-engage-close","js-engage-promotion-close","js-engage-promotion-button","js-engage-promotion-image","js-engage-promotion-a"],i=!1,a=!1,o="",c=[];t=JSON.parse(n.getAttribute("data-pt-action")||"{}"),a="false"===(n.getAttribute("data-pt-status")||String(t.status)),o=n.getAttribute("data-pt-type")||String(t.type),c=n.className||n.classList.value,!(i=function(){for(var e=0,t=r.length;e<t;e++)if(-1!==c.indexOf(r[e]))return!0}())&&(n=n.parentNode),!i&&n!=f;);if(a)e.preventDefault();else if(i){e.preventDefault();var u=n.tagName.toUpperCase(),s=n.textContent||u||"unknow target";if(n.parentNode&&"image"==n.parentNode.getAttribute("data-engage-block")){var l=n.querySelector("img");l&&(s=l.getAttribute("alt"))}if("3"===o||-1!=c.indexOf("js-engage-close")||-1!=c.indexOf("js-engage-promotion-close"))return la().removeChild(f),p.shouldCreateMaskLayer&&hi(p.engagerId),pi(g,p,"close",s),void(h&&"function"==typeof h&&h(p.exp_id,"hasClosed"));if(pi(g,p,"click",s),n.href&&!/^javascript:(void\(0\))?;?$/.test(n.href))if("_blank"==n.target)try{window.open(n.href,"_blank")}catch(d){hr(),vr("WindowOpenError",d)}else location.href=n.href;h&&"function"==typeof h&&h(p.exp_id)}})}function sa(e,t){var n=e||{css:"",html:"",script:""},r=n.css,i=n.html,a=n.script;return bi(r,t),i+a}function la(){var e=document.getElementById(zi);return e||((e=document.createElement("div")).setAttribute("id",zi),document.body.appendChild(e)),e}function da(e){var t=document.getElementById(e);return t||(t=document.createElement("div")).setAttribute("id",e),t}function fa(e){return"engage_"+e}var ga=function(e){!function t(){var e=document.getElementById(zi);e&&document.body.removeChild(e)}(),e.on("next",function(e,t){hr(),function n(e){hr(),hr(),hr(),aa(e)}(e)})},ha="__pt__engager__common__style",pa=function(e){e.on("next",function(){if(!document.getElementById(ha)){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.id=ha,e.href=("https:"===location.protocol?"https://":"http://")+"pteengagecss.ptengine.jp/styles/engager.css",document.getElementsByTagName("head")[0].appendChild(e)}!function t(){var e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(".engage-promotion-wrap{display:none}")),document.getElementsByTagName("head")[0].appendChild(e)}()})};function va(e,t){window.CustomEvent=window.CustomEvent||function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return e.prototype=window.Event.prototype,e}();try{return new window.CustomEvent(e,t)}catch(n){return null}}function ma(e){return function(){if(0!==arguments.length)switch(arguments[0]){case"showEngagement":!function i(e,t){if(t){var n=e.engager,r=e.setting;Array.isArray(r)||(r=(e.setting||{}).configs||[]),r.filter(function(e){return e.engageId==t}).length<=0?hr():n.emit("showEngagement.".concat(t))}else hr()}(e,arguments[1]);break;case"toggleEngagement":!function a(e,t){if(t){var n=e.engager,r=e.setting;Array.isArray(r)||(r=(e.setting||{}).configs||[]),r.filter(function(e){return e.engageId==t}).length<=0?hr():n.emit("toggleEngagement.".concat(t))}else hr()}(e,arguments[1])}else hr()}}var ya=function(){function t(){cn(this,t);var e="https:"===location.protocol?"https://":"http://";this._callbacks={},this.collectUrl=e+"xcollector.ptengine.jp/webcollect"}return sn(t,[{key:"on",value:function(e,t){return this._callbacks["$"+e]||(this._callbacks["$"+e]=[]),this._callbacks["$"+e].push(t),this}},{key:"off",value:function(e,t){if(0===arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1===arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this}},{key:"once",value:function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this}},{key:"emit",value:function(e){for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n)for(var i=0,a=(n=n.slice(0)).length;i<a;++i)n[i].apply(this,t);return this}},{key:"hasListeners",value:function(e){return 0<(this._callbacks["$"+e]||[]).length}}]),t}();var wa=function(){function t(e){cn(this,t),this.timestamp=(new Date).getTime(),this.type=e}return sn(t,[{key:"set",value:function(e,t){if(e&&"string"==typeof e)for(var n=e.split("."),r=this,i=0,a=n.length;i<a;i++){var o=n[i];r[o]||(r[o]={}),i===a-1&&(r[o]=t),r=r[o]}return this}},{key:"setPage",value:function(){var e=0<arguments.length&&arguments[0]!==undefined?arguments[0]:"page",t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:{},n=Ir.vn,r=Ir.pvn,i=(new Date).getTime()-xr;i<0&&(i=0),this.set("name",e).set("properties",t).set("vn",n).set("pvn",r).set("loadtime",i).set("context",ba()).set("context.page",this.getDefaultPage())}},{key:"setEvent",value:function(e,t){"track"===this.type&&this.set("context",ba()).set("context.page",this.getDefaultPage()),this.set("event",e),t&&this.set("properties",t)}},{key:"setUser",value:function(e,t,n){e&&this.set("accountId",e),t&&this.set("properties",t),n&&this.set("source",n)}},{key:"setStatus",value:function(e,t){e&&this.set("accountId",e),t&&this.set("properties",t)}},{key:"setCampaign",value:function(e){this.set("context",ba()),e&&this.set("context.campaign",e)}},{key:"setEngage",value:function(e){var t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:{};this.set("engage",e),t&&this.set("properties",t)}},{key:"getFields",value:function(){return this.set("packageId",nr()),window.PT_ENGAGE_IN_DEBUG&&(this.set("previewMode",!0),this.set("previewId",localStorage.getItem("ptx_previewId"))),Object.assign({},this,Ir)}},{key:"getDefaultPage",value:function(){return{hostname:location.hostname,referrer:document.referrer,refType:function t(e){return e?1:0}(document.referrer),title:document.title,url:location.href}}}]),t}();function ba(){return{timezone:function n(){try{var e=(new Date).getTimezoneOffset();return e||0===e?"GMT"+(e<=0?"+":"")+e/60*-1:""}catch(t){return""}}(),language:navigator.language,screen:{width:function r(){try{var e=window.screen.width;return e?isNaN(parseInt(e,10))?0:parseInt(e,10):0}catch(t){return 0}}(),height:function i(){try{var e=window.screen.height;return e?isNaN(parseInt(e,10))?0:parseInt(e,10):0}catch(t){return 0}}()}}}var _a="pt:on_engage_fired",ka="pt:start_engage_render",Ea=function(e){fn(n,ya);var t=vn(n);function n(){return cn(this,n),t.apply(this,arguments)}return sn(n,[{key:"page",value:function(e,t,r){var i=this;if(Ar()){var n=new wa("page");n.setPage(e,t);try{var a=JSON.stringify(n.getFields());tr({url:this.collectUrl,method:"POST",data:a,callback:function(e){try{var t=JSON.parse(e);"success"===t.status&&(i.emit(ka,t.content),r&&"function"==typeof r&&r())}catch(n){}}})}catch(o){vr("PageViewModuleError",o)}}}}]),n}(),Sa=function(e){fn(n,ya);var t=vn(n);function n(){return cn(this,n),t.call(this)}return sn(n,[{key:"identify",value:function(e,t,n){var r=this,i=new wa("identify");Ar()&&(i.setUser(e,t,n),tr({url:this.collectUrl,method:"POST",data:JSON.stringify(i.getFields()),callback:function(e){try{var t=JSON.parse(e);"success"==t.status&&r.emit(ka,t.content)}catch(n){}}}))}},{key:"status",value:function(e,t){var r=this,n=new wa("status");Ar()&&(n.setStatus(e,t),tr({url:this.collectUrl,method:"POST",data:JSON.stringify(n.getFields()),callback:function(e){try{var t=JSON.parse(e);"success"==t.status&&r.emit(ka,t.content)}catch(n){}}}))}}]),n}(),Ta=(new Date).getTime(),Ia=0,xa=function(e){fn(n,ya);var t=vn(n);function n(){var e;return cn(this,n),(e=t.call(this)).vistualEvents=[],e.uncommitedEvents=[],e.isTimeout=!1,e.init(),e}return sn(n,[{key:"init",value:function(){var t=this;function r(){(new Date).getTime()-Tr.lastUpdateTime>Tr.SILENCEDURATION?(clearInterval(window.ptx_heartbeat_interval),this.isTimeout=!0):this.emit("heartbeat")}function l(e,t){for(var n=!1;e==t?n=!0:e=e.parentNode,"body"!==e.nodeName.toLowerCase()&&!n;);return n}(function e(){var s=this;window.addEventListener("click",function(e){var o=(e=e||window.event).target||e.srcElement,t=o.nodeName.toLowerCase(),n=(new Date).getTime();if(n-Ia<Tr.CLICKINTERVAL&&"a"!==t)return!1;Ia=n,Nr("lastUpdateTime",(new Date).getTime());var c=null;if(o&&0<s.vistualEvents.length){var u=function u(e){var r=s.vistualEvents[e];try{var t=document.querySelectorAll(decodeURIComponent(decodeURIComponent(r.csspath)));if(c===t[0])return"continue";for(var n in c=t[0],t){var i=t[n];l(o,i)&&s.addEvent(r.eventName)}s.commit()}catch(a){!function uT(t,n){if(window.jQuery)n();else{var r=!1,i=document.getElementsByTagName("head")[0],a=document.createElement("script");a.src=t,i.appendChild(a),a.onload=a.onreadystatechange=function(){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(r=!0,n(),a.onload=a.onreadystatechange=null,i&&a.parentNode&&i.removeChild(a))}}}("https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js",function(){var e=window.jQuery(r.csspath);for(var t in e){var n=e[t];l(o,n[0])&&s.addEvent(r.eventName)}})}};for(var r in s.vistualEvents)u(r)}c||(s.emit("click"),c=null)},!0)}).call(this),function i(){var e,n=this;this.on("click",function(){n.isTimeout?(n.isTimeout=!1,n.emit("reactivated"),window.ptx_heartbeat_interval=setInterval(function(){r.call(n)},Tr.HEARTBEATINTERVAL)):n.emit("heartbeat")}),this.on("heartbeat",function(){var e=new wa("heartbeat");if(Ar()){var t=(new Date).getTime();return e.set("duration",t-Ta),Ir.profileId?tr({url:n.collectUrl,method:"POST",data:JSON.stringify(e.getFields())}):void 0}}),window.addEventListener("scroll",function(){e&&clearTimeout(e),e=setTimeout(function(){Nr("lastUpdateTime",(new Date).getTime()),n.emit("heartbeat")},500)}),window.ptx_heartbeat_interval=window.setInterval(function(){r.call(n)},Tr.HEARTBEATINTERVAL)}.call(this),this.on("pt:on_vistualevent_fetch_done",function(e){t.vistualEvents=function a(e){var t=[];for(var n in e){var r=e[n],i=r.split(",");new RegExp(i[6].replace(/^\//,"").replace(/\/$/,"")).test(location.href.replace(/\/$/,""))&&i[3]&&i&&"string"==typeof i[7]&&t.push({csspath:decodeURIComponent(i[7]),eventName:i[3]})}return t}(e)})}},{key:"trackEvent",value:function(e){var t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:{},n=!(2<arguments.length&&arguments[2]!==undefined)||arguments[2];if(Ar()){var r=new wa("track");return e&&r.setEvent(e,t),n&&ki("setCustomVarV2",Object.assign({},t||{},{eventName:e})),this.dispatch(JSON.stringify(r.getFields()))}}},{key:"commit",value:function(){var e=this.uncommitedEvents.length;if(0<e){var t=new wa("track");if(!Ar())return;1===e?t.setEvent(this.uncommitedEvents[0].name):t.setEvent(this.uncommitedEvents);var n=JSON.stringify(t.getFields());return this.uncommitedEvents=[],this.dispatch(n)}}},{key:"addEvent",value:function(e,t){return this.uncommitedEvents.push({name:e}),this}},{key:"dispatch",value:function(e){var r=this;return tr({url:this.collectUrl,method:"POST",data:e,callback:function(e){try{var t=JSON.parse(e);"success"===t.status&&r.emit(ka,t.content)}catch(n){}}})}}]),n}(),Oa=function(e){fn(n,ya);var t=vn(n);function n(){return cn(this,n),t.apply(this,arguments)}return sn(n,[{key:"engage",value:function(e,t){var n=new wa("engage");Ar()&&(n.setEngage(e,t),tr({url:this.collectUrl,method:"POST",data:JSON.stringify(n.getFields()),callback:function(e){try{JSON.parse(e).status}catch(t){}}}))}}]),n}(),Ca=function(e){fn(r,ya);var n=vn(r);function r(e){var t;return cn(this,r),(t=n.call(this)).engager=e,t._page=new Ea,t._user=new Sa,t._event=new xa,t._engage=new Oa,t.init(),t}return sn(r,[{key:"init",value:function(){var t=this;this._event.on(ka,function(e){t.emit(_a,e)}),this._page.on(ka,function(e){t.emit(_a,e)}),this._user.on(ka,function(e){t.emit(_a,e)}),this._engage.on(ka,function(e){t.emit(_a,e)}),this._event.on("reactivated",function(e){Cr("reactivated"),t.page()})}},{key:"track",value:function(e,t){var n=!(2<arguments.length&&arguments[2]!==undefined)||arguments[2];this._event.trackEvent(e,t,n)}},{key:"page",value:function(e,t,n){Cr("changePage"),this._page.page(e,t,n)}},{key:"identify",value:function(e,t,n){this._user.identify(e,t,n)}},{key:"status",value:function(e,t){this._user.status(e,t)}},{key:"engage",value:function(e,t){this._engage.engage(e,t)}},{key:"showEngagement",value:function(e){this.engager.emit("showEngage.".concat(e))}}]),r}();var Na=function(t){var o=new Ca(t),a=window[[zn.dataLayer]]||[],c=function c(e){try{var t=e||{},n=t.event,r=t.name,i=t.property;n&&o[n]&&"function"==typeof o[n]&&o[n](r,i)}catch(a){}},n=function n(){o.page("","",function(){var t=(a||{}).hide;if(t&&t.end&&setTimeout(function(){try{t.end()}catch(e){}},0),window[zn.funName].__antiFlicker){var e=window[zn.funName].__antiFlicker,n=e.hasInline,r=e.end;if(r){var i=function i(){try{r&&r()}catch(e){}};n?"complete"===document.readyState?i():(lr(document,"DOMContentLoaded",i),lr(document,"readystatechange",i),lr(window,"load",i)):setTimeout(function(){i()},0)}}}),a.forEach(function(e){c(e)})},r=!1;(window[zn.funName]||[]).forEach(function(e){var t=e||[];switch(t[0]){case"page":o.page(t[1],t[2]),r=!0;break;case"track":a.push({event:"track",name:t[1],property:t[2]});break;case"identify":a.push({event:"identify",name:t[1],property:t[2]})}}),r&&vr("ExecuteException","page view init exception"),a.push=function(e){c(e)},-1!==navigator.userAgent.indexOf("Safari")&&-1!==navigator.userAgent.indexOf("Version")?t.on("send.pageview",function(e){n()}):n();var e=window[zn.funName]||{},i=e.__ver,u=e.__pteSid,s=e.__start,l=e.__antiFlicker,d=e.__ptenginex,f=e.__ptePeid;window[zn.funName]=o,[{key:"__ver",value:i},{key:"__pteSid",value:u},{key:"__start",value:s},{key:"__antiFlicker",value:l},{key:"__ptenginex",value:d},{key:"__ptePeid",value:f}].forEach(function(e){e.value&&(window[zn.funName][e.key]=e.value)}),window[zn.funName].__sid=yr(),function g(){try{var e=new va("ptEventReady",{bubbles:!1,cancelable:!1,detail:{}});e&&(window.dispatchEvent&&"function"==typeof window.dispatchEvent?window.dispatchEvent(e):window.fireEvent&&"function"==typeof window.fireEvent&&window.fireEvent(e))}catch(t){}}(),t.on("send.engage",function(e){o.engage(e)}),o.on(_a,function(e){t.emit("run.setting",e)})};if(window.ptengine&&!window.ptengine.__ptenginex){window.ptengine.__ptenginex="1.0.0";var Aa=new e;Or(),localStorage.removeItem("ptx_engager_debug"),Aa.use(function Ra(d,e){hr(),hr(),d.send=function(e,t){var n=t.engagerId,r=t.engagerVerId,i=t.variant||{},a=t.triggerCondition;if("click"===e&&(a="click"),Ar()){var o=Ir.pageId,c=Ir.pageviewId,u={sid:c,uid:Ir.deviceId,vid:Ir.sessionId,pid:o,peid:c,ts:(new Date).getTime(),engagerId:n,engagerVerId:r,triggerCondition:a,engagerType:e,variant:i};window.PT_ENGAGE_IN_DEBUG&&(u.previewMode=!0,u.previewId=localStorage.getItem("ptx_previewId")||"");var s=d.engager||window.$$__ptx_engage_$;try{s.emit("send.engage",{name:"",id:n,versionId:r,action:e,properties:i})}catch(l){vr("NullException",l)}}},hr(),e()}).use(function Wa(e,t){window.localStorage?(hr(),function(e,t){if(hr(),t&&Array.isArray(t))for(var n=ai(),r=0,i=t.length;r<i;r++){var a=t[r];if("3.0"!==a.engageVersion){for(var o=a.timezone,c=a.experiments,u=a.rates,s=c.rate||u,l=0,d=0,f=[],g=0,h=s.length;g<h;g++)f.push({min:100*d,max:100*(d+s[g])}),d+=s[g];var p=Ir.deviceId;hr();for(var v=mr(p)%99,m=0,y=f.length;m<y;m++)if(v>=f[m].min&&v<f[m].max){l=m;break}hr(),hr(),hr();var w=c.experiment?c.experiment[l]:c[l];w&&(e.current=w,e.current.engagerId=a.engageId,e.current.isVersionEvent=a.isVersionEvent,e.current.isOriginalVersion=a.isOriginalVersion);var b=e.current,_=!0;if(b.config.session&&0<b.config.session.length)for(var k=0;k<b.config.session.length;k++)if(0===b.config.session[k].status){_=!1;break}if(_){if(hr(),b.stopToDisplay=b.stopToDisplay||b.config.stop,b.stopToDisplay&&0<b.stopToDisplay.length)for(var E=b.stopToDisplay,S=0,T=E.length;S<T;S++){var I=E[S];if(n.setValue({value:I.value,current:e.current,context:e}),n.setCondition(I.condition),n.setValidator(ri(I.type)),n.run(),!e.current.goNext){hr();break}}else e.current.goNext=!0;hr();var x=!0;if(b.displayTime=b.displayTime||b.config.schedule,b.timezone=o||b.config.timezone&&b.config.timezone.profile,b.displayTime&&0<b.displayTime.length){var O=b.displayTime,C=(b.config.timezone||{}).useVisitor;kr.setTimeZone(""),!C&&kr.setTimeZone(o||""),Array.isArray(O)||(O=[O]);for(var N=0;N<O.length;N++){var A=O[N];if(n.setValue(A.value),n.setValidator(ri(A.type)),hr(0,n.run()),!n.run()){x=!1,hr();break}}}if(hr(),x&&e.current.goNext)if(b.startToDisplay=b.startToDisplay||b.config.start,b.startToDisplay&&0<b.startToDisplay.length){var D=b.startToDisplay;Array.isArray(D)||(D=[D]);for(var P=0,L=D.length;P<L;P++){var R=D[P];n.setValue({value:R.value,current:e.current,context:e}),n.setCondition(R.condition),n.setValidator(ri(R.type)),n.run(),hr()}}else hr(),e.engager.emit("next",e)}}else{var W=a,M=(W.engageId,W.versions),j=(W.goals,W.schedule),V=(W.conditions,W.timezone),U=W.heatmapVersion,F=((j||[])[0]||{timezone:{}}).timezone.useVisitor,G=M&&M[0];if(!G)continue;if(G&&(W.currentVersionId=G.versionId,e.current=W),U){e.current.goNext=!0,e.engager.emit("next",e);continue}e.current.goNext=!0,oi(e,n,((j||[])[0]||{}).versionData||[],V,F)&&e.engager.emit("next",e)}}}(e,e.setting||[]),t()):hr()}).use(function Ma(e,t){try{var n=new va("ptEventReady",{bubbles:!1,cancelable:!1,detail:{}});n&&(window.Ptengine=ma(e),document.dispatchEvent&&"function"==typeof document.dispatchEvent?document.dispatchEvent(n):document.fireEvent&&"function"==typeof document.fireEvent&&document.fireEvent(n))}catch(r){}t()}),-1===location.href.indexOf("preview_token=")&&Na(Aa),pa(Aa),ga(Aa),Aa.init()}}();
